<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CLI: shell.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="namespaces.html"><span>Namespaces</span></a></li>
    <li><a href="classes.html"><span>Classes</span></a></li>
    <li id="current"><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
  </ul></div>
<div class="tabs">
  <ul>
    <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
  </ul></div>
<div class="nav">
<a class="el" href="dir_ee6a9aa9a640f270615eb3e35f15e577.html">cpp</a>&nbsp;&raquo&nbsp;<a class="el" href="dir_a44934a216507e551836306841a18604.html">src</a></div>
<h1>shell.cpp</h1><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment">    Copyright (c) 2006-2009, Alexis Royer, http://alexis.royer.free.fr/CLI</span>
<a name="l00003"></a>00003 <span class="comment"></span>
<a name="l00004"></a>00004 <span class="comment">    All rights reserved.</span>
<a name="l00005"></a>00005 <span class="comment"></span>
<a name="l00006"></a>00006 <span class="comment">    Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:</span>
<a name="l00007"></a>00007 <span class="comment"></span>
<a name="l00008"></a>00008 <span class="comment">        * Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.</span>
<a name="l00009"></a>00009 <span class="comment">        * Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.</span>
<a name="l00010"></a>00010 <span class="comment">        * Neither the name of the CLI library project nor the names of its contributors may be used to endorse or promote products derived from this software without specific prior written permission.</span>
<a name="l00011"></a>00011 <span class="comment"></span>
<a name="l00012"></a>00012 <span class="comment">    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<a name="l00013"></a>00013 <span class="comment">    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<a name="l00014"></a>00014 <span class="comment">    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<a name="l00015"></a>00015 <span class="comment">    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR</span>
<a name="l00016"></a>00016 <span class="comment">    CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,</span>
<a name="l00017"></a>00017 <span class="comment">    EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,</span>
<a name="l00018"></a>00018 <span class="comment">    PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR</span>
<a name="l00019"></a>00019 <span class="comment">    PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF</span>
<a name="l00020"></a>00020 <span class="comment">    LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING</span>
<a name="l00021"></a>00021 <span class="comment">    NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS</span>
<a name="l00022"></a>00022 <span class="comment">    SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<a name="l00023"></a>00023 <span class="comment">*/</span>
<a name="l00024"></a>00024 
<a name="l00025"></a>00025 
<a name="l00026"></a>00026 <span class="preprocessor">#include "<a class="code" href="pch_8h.html">cli/pch.h</a>"</span>
<a name="l00027"></a>00027 
<a name="l00028"></a>00028 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00029"></a>00029 <span class="preprocessor">#include &lt;string.h&gt;</span>
<a name="l00030"></a>00030 
<a name="l00031"></a>00031 <span class="preprocessor">#include "<a class="code" href="shell_8h.html">cli/shell.h</a>"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#include "<a class="code" href="io__device_8h.html">cli/io_device.h</a>"</span>
<a name="l00033"></a>00033 <span class="preprocessor">#include "<a class="code" href="io__mux_8h.html">cli/io_mux.h</a>"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#include "<a class="code" href="mt__device_8h.html">cli/mt_device.h</a>"</span>
<a name="l00035"></a>00035 <span class="preprocessor">#include "<a class="code" href="cli_8h.html">cli/cli.h</a>"</span>
<a name="l00036"></a>00036 <span class="preprocessor">#include "<a class="code" href="menu_8h.html">cli/menu.h</a>"</span>
<a name="l00037"></a>00037 <span class="preprocessor">#include "<a class="code" href="command__line_8h.html">cli/command_line.h</a>"</span>
<a name="l00038"></a>00038 <span class="preprocessor">#include "<a class="code" href="endl_8h.html">cli/endl.h</a>"</span>
<a name="l00039"></a>00039 <span class="preprocessor">#include "<a class="code" href="param_8h.html">cli/param.h</a>"</span>
<a name="l00040"></a>00040 <span class="preprocessor">#include "<a class="code" href="traces_8h.html">cli/traces.h</a>"</span>
<a name="l00041"></a>00041 <span class="preprocessor">#include "<a class="code" href="assert_8h.html">cli/assert.h</a>"</span>
<a name="l00042"></a>00042 <span class="preprocessor">#include "<a class="code" href="debug_8h.html">cli/debug.h</a>"</span>
<a name="l00043"></a>00043 <span class="preprocessor">#include "<a class="code" href="consistency_8h.html">consistency.h</a>"</span>
<a name="l00044"></a>00044 <span class="preprocessor">#include "<a class="code" href="constraints_8h.html">constraints.h</a>"</span>
<a name="l00045"></a>00045 <span class="preprocessor">#include "<a class="code" href="command__line__edition_8h.html">command_line_edition.h</a>"</span>
<a name="l00046"></a>00046 <span class="preprocessor">#include "<a class="code" href="command__line__history_8h.html">command_line_history.h</a>"</span>
<a name="l00047"></a>00047 
<a name="l00048"></a>00048 <a class="code" href="namespace_8h.html#965caf70ca576c007bee150001248651">CLI_NS_USE</a>(cli)
<a name="l00049"></a>00049 
<a name="l00050"></a>00050 
<a name="l00051"></a>00051 static const <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> HELP_MARGIN = 2;
<a name="l00052"></a>00052 static const <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> HELP_OFFSET = 15;
<a name="l00053"></a>00053 static const <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> HISTORY_PAGE = 5;
<a name="l00054"></a>00054 static const <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> HISTORY_STACK_SIZE = 100;
<a name="l00055"></a>00055 
<a name="l00057"></a>00057 <span class="preprocessor">#define TRACE_SHELL GetShellTraceClass()</span>
<a name="l00059"></a>00059 <span class="preprocessor">static const TraceClass&amp; GetShellTraceClass(void)</span>
<a name="l00060"></a>00060 <span class="preprocessor"></span>{
<a name="l00061"></a>00061     <span class="keyword">static</span> <span class="keyword">const</span> <a class="code" href="classTraceClass.html">TraceClass</a> cli_ShellTraceClass(<span class="stringliteral">"CLI_SHELL"</span>, <a class="code" href="classHelp.html">Help</a>()
<a name="l00062"></a>00062         .AddHelp(<a class="code" href="classResourceString.html#88d585d899c8482aeb434571923739b3f12fbeaebaa487c3970ecc2cf837e0df">Help::LANG_EN</a>, <span class="stringliteral">"Shell traces"</span>)
<a name="l00063"></a>00063         .AddHelp(<a class="code" href="classResourceString.html#88d585d899c8482aeb434571923739b3142a22fb5f61fe5c723693b4cc887f4f">Help::LANG_FR</a>, <span class="stringliteral">"Traces du shell"</span>));
<a name="l00064"></a>00064     <span class="keywordflow">return</span> cli_ShellTraceClass;
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00067"></a>00067 
<a name="l00068"></a>00068 Shell::Shell(<span class="keyword">const</span> <a class="code" href="classCli.html">Cli</a>&amp; CLI_Cli)
<a name="l00069"></a>00069   : m_pcliCli(&amp; CLI_Cli), m_pcliInput(NULL),
<a name="l00070"></a>00070     m_eLang(<a class="code" href="classHelp.html">Help</a>::LANG_EN), m_bBeep(true),
<a name="l00071"></a>00071     m_qMenus(MAX_MENU_PER_CLI),
<a name="l00072"></a>00072     m_cliCmdLine(* new <a class="code" href="classCmdLineEdition.html">CmdLineEdition</a>()),
<a name="l00073"></a>00073     m_cliHistory(* new <a class="code" href="classCmdLineHistory.html">CmdLineHistory</a>(HISTORY_STACK_SIZE)),
<a name="l00074"></a>00074     m_eThreadSafeCmd(THREAD_SAFE_NONE),
<a name="l00075"></a>00075     m_bRestoreTracesOnFinish(false)
<a name="l00076"></a>00076 {
<a name="l00077"></a>00077     <a class="code" href="consistency_8h.html#cd519988d0498954c9a9507773b172b7">EnsureCommonDevices</a>();
<a name="l00078"></a>00078     <a class="code" href="consistency_8h.html#ed1a89fb454edbbeb912461221e72014">EnsureTraces</a>();
<a name="l00079"></a>00079 
<a name="l00080"></a>00080     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd6468bb89aa87bc8aca527770d9191a809e8">STREAM_TYPES_COUNT</a>; i++)
<a name="l00081"></a>00081     {
<a name="l00082"></a>00082         m_artStream[i].pcliStream = NULL;
<a name="l00083"></a>00083         m_artStream[i].bEnable = <span class="keyword">true</span>;
<a name="l00084"></a>00084     }
<a name="l00085"></a>00085 
<a name="l00086"></a>00086     <span class="keywordflow">if</span> (! m_qMenus.AddHead(&amp; CLI_Cli))
<a name="l00087"></a>00087     {
<a name="l00088"></a>00088         <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(<a class="code" href="traces_8h.html#243b1b1f8ca7e7e98ac73a2d115256f4">INTERNAL_ERROR</a>) &lt;&lt; <span class="stringliteral">"Could not set initial shell status."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00089"></a>00089     }
<a name="l00090"></a>00090     CLI_Cli.<a class="code" href="classCli.html#4b31c55366703eba5c83cfe03951b651">SetShell</a>(*<span class="keyword">this</span>);
<a name="l00091"></a>00091 
<a name="l00092"></a>00092     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(TRACE_SHELL) &lt;&lt; <span class="stringliteral">"New shell for CLI '"</span> &lt;&lt; GetCli().GetKeyword() &lt;&lt; <span class="stringliteral">"'."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00093"></a>00093 }
<a name="l00094"></a>00094 
<a name="l00095"></a>00095 <a class="code" href="classShell.html#5fb783e6c351da01e9a2445d232f07b1">Shell::~Shell</a>(<span class="keywordtype">void</span>)
<a name="l00096"></a>00096 {
<a name="l00097"></a>00097     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(TRACE_SHELL) &lt;&lt; <span class="stringliteral">"Shell deleted for CLI '"</span> &lt;&lt; <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">GetCli</a>().<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>() &lt;&lt; <span class="stringliteral">"'."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00098"></a>00098 
<a name="l00099"></a>00099     <span class="keywordflow">if</span> (m_pcliInput != NULL)
<a name="l00100"></a>00100     {
<a name="l00101"></a>00101         m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#ecfe1a98108afdbf1262c6a05ee7d766">FreeInstance</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>);
<a name="l00102"></a>00102         m_pcliInput = NULL;
<a name="l00103"></a>00103     }
<a name="l00104"></a>00104 
<a name="l00105"></a>00105     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;STREAM_TYPES_COUNT; i++)
<a name="l00106"></a>00106     {
<a name="l00107"></a>00107         <span class="keywordflow">if</span> (m_artStream[i].pcliStream != NULL)
<a name="l00108"></a>00108         {
<a name="l00109"></a>00109             m_artStream[i].pcliStream-&gt;<a class="code" href="classOutputDevice.html#ecfe1a98108afdbf1262c6a05ee7d766">FreeInstance</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>);
<a name="l00110"></a>00110             m_artStream[i].pcliStream = NULL;
<a name="l00111"></a>00111         }
<a name="l00112"></a>00112     }
<a name="l00113"></a>00113 
<a name="l00114"></a>00114     <span class="keyword">delete</span> &amp; m_cliCmdLine;
<a name="l00115"></a>00115     <span class="keyword">delete</span> &amp; m_cliHistory;
<a name="l00116"></a>00116 }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118 <span class="keyword">const</span> <a class="code" href="classCli.html">Cli</a>&amp; <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">Shell::GetCli</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00119"></a>00119 <span class="keyword"></span>{
<a name="l00120"></a>00120     <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(m_pcliCli != NULL);
<a name="l00121"></a>00121     <span class="keywordflow">return</span> *m_pcliCli;
<a name="l00122"></a>00122 }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124 <span class="keyword">const</span> <a class="code" href="classIODevice.html">IODevice</a>&amp; <a class="code" href="classShell.html#d2291c8673fec28e2f8151f09413b6a1">Shell::GetInput</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00125"></a>00125 <span class="keyword"></span>{
<a name="l00126"></a>00126     <span class="keywordflow">if</span> (m_pcliInput != NULL)
<a name="l00127"></a>00127     {
<a name="l00128"></a>00128         <span class="keywordflow">return</span> *m_pcliInput;
<a name="l00129"></a>00129     }
<a name="l00130"></a>00130     <span class="keywordflow">else</span>
<a name="l00131"></a>00131     {
<a name="l00132"></a>00132         <span class="keywordflow">return</span> <a class="code" href="classIODevice.html#b885b886d893f95ab6addf47d125c93e">IODevice::GetStdIn</a>();
<a name="l00133"></a>00133     }
<a name="l00134"></a>00134 }
<a name="l00135"></a>00135 
<a name="l00136"></a>00136 <span class="keyword">const</span> <a class="code" href="classOutputDevice.html">OutputDevice</a>&amp; <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">Shell::GetStream</a>(<span class="keyword">const</span> <a class="code" href="shell_8h.html#8777d6765665b0c44a1caa09dc335fe3">STREAM_TYPE</a> E_StreamType)<span class="keyword"> const</span>
<a name="l00137"></a>00137 <span class="keyword"></span>{
<a name="l00138"></a>00138     <span class="keywordflow">if</span> ((E_StreamType &gt;= 0) &amp;&amp; (E_StreamType &lt; STREAM_TYPES_COUNT))
<a name="l00139"></a>00139     {
<a name="l00140"></a>00140         <span class="keywordflow">if</span> (m_artStream[E_StreamType].bEnable)
<a name="l00141"></a>00141         {
<a name="l00142"></a>00142             <span class="comment">// This is a hack to have IOMux multiplexing output correctly.</span>
<a name="l00143"></a>00143             <span class="keyword">const</span> <a class="code" href="classOutputDevice.html">OutputDevice</a>* pcli_Stream = m_artStream[E_StreamType].pcliStream;
<a name="l00144"></a>00144             <span class="keywordflow">while</span> (<span class="keyword">const</span> <a class="code" href="classIOMux.html">IOMux</a>* <span class="keyword">const</span> pcli_IOMux = dynamic_cast&lt;const IOMux*&gt;(pcli_Stream))
<a name="l00145"></a>00145             {
<a name="l00146"></a>00146                 pcli_Stream = &amp; pcli_IOMux-&gt;GetOutput(E_StreamType);
<a name="l00147"></a>00147             }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149             <span class="keywordflow">if</span> (pcli_Stream != NULL)
<a name="l00150"></a>00150             {
<a name="l00151"></a>00151                 <span class="keywordflow">return</span> *pcli_Stream;
<a name="l00152"></a>00152             }
<a name="l00153"></a>00153         }
<a name="l00154"></a>00154     }
<a name="l00155"></a>00155     <span class="keywordflow">else</span>
<a name="l00156"></a>00156     {
<a name="l00157"></a>00157         <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(<span class="keyword">false</span>);
<a name="l00158"></a>00158     }
<a name="l00159"></a>00159 
<a name="l00160"></a>00160     <span class="comment">// Default to null device.</span>
<a name="l00161"></a>00161     <span class="keywordflow">return</span> <a class="code" href="classOutputDevice.html#f8c578fdf04a330919cfc735b8a15d76">OutputDevice::GetNullDevice</a>();
<a name="l00162"></a>00162 }
<a name="l00163"></a>00163 
<a name="l00164"></a>00164 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classShell.html#b8ef37dc6a98ba279bf0901e2cd9155c">Shell::SetStream</a>(<span class="keyword">const</span> <a class="code" href="shell_8h.html#8777d6765665b0c44a1caa09dc335fe3">STREAM_TYPE</a> E_StreamType, <a class="code" href="classOutputDevice.html">OutputDevice</a>&amp; CLI_Stream)
<a name="l00165"></a>00165 {
<a name="l00166"></a>00166     <span class="comment">// ALL_STREAMS management.</span>
<a name="l00167"></a>00167     <span class="keywordflow">if</span> (E_StreamType == <a class="code" href="shell_8h.html#831be33be460d85af138038078ebd6464a3d58d84486a4d788ec5e59ccd21b27">ALL_STREAMS</a>)
<a name="l00168"></a>00168     {
<a name="l00169"></a>00169         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; STREAM_TYPES_COUNT; i++)
<a name="l00170"></a>00170         {
<a name="l00171"></a>00171             <span class="keywordflow">if</span> (! <a class="code" href="classShell.html#b8ef37dc6a98ba279bf0901e2cd9155c">SetStream</a>((<a class="code" href="shell_8h.html#8777d6765665b0c44a1caa09dc335fe3">STREAM_TYPE</a>) i, CLI_Stream))
<a name="l00172"></a>00172             {
<a name="l00173"></a>00173                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00174"></a>00174             }
<a name="l00175"></a>00175         }
<a name="l00176"></a>00176 
<a name="l00177"></a>00177         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00178"></a>00178     }
<a name="l00179"></a>00179     <span class="keywordflow">if</span> ((E_StreamType &lt; 0) || (E_StreamType &gt;= STREAM_TYPES_COUNT))
<a name="l00180"></a>00180     {
<a name="l00181"></a>00181         <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(<span class="keyword">false</span>);
<a name="l00182"></a>00182         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00183"></a>00183     }
<a name="l00184"></a>00184     <span class="comment">// End of ALL_STREAMS management.</span>
<a name="l00185"></a>00185 
<a name="l00186"></a>00186     <span class="comment">// Free previous reference.</span>
<a name="l00187"></a>00187     <span class="keywordflow">if</span> (<a class="code" href="classOutputDevice.html">OutputDevice</a>* <span class="keyword">const</span> pcli_Stream = m_artStream[E_StreamType].pcliStream)
<a name="l00188"></a>00188     {
<a name="l00189"></a>00189         <span class="keywordtype">bool</span> b_Res = <span class="keyword">true</span>;
<a name="l00190"></a>00190 
<a name="l00191"></a>00191         <span class="comment">// Unreference the device right now.</span>
<a name="l00192"></a>00192         m_artStream[E_StreamType].pcliStream = NULL;
<a name="l00193"></a>00193         <span class="keywordflow">if</span> (<a class="code" href="classShell.html#562d5552796bb86d3fcc5a3ce0680cf4">IsRunning</a>())
<a name="l00194"></a>00194         {
<a name="l00195"></a>00195             <span class="keywordflow">if</span> (! pcli_Stream-&gt;<a class="code" href="classOutputDevice.html#810d944acedbf6fa139fb852ff547957">CloseDown</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>))
<a name="l00196"></a>00196             {
<a name="l00197"></a>00197                 PrintError(<a class="code" href="classResourceString.html">ResourceString</a>(), pcli_Stream-&gt;<a class="code" href="classOutputDevice.html#1049ff5527f478db965a6629ebfd2f00">GetLastError</a>());
<a name="l00198"></a>00198                 b_Res = <span class="keyword">false</span>;
<a name="l00199"></a>00199             }
<a name="l00200"></a>00200         }
<a name="l00201"></a>00201         pcli_Stream-&gt;<a class="code" href="classOutputDevice.html#ecfe1a98108afdbf1262c6a05ee7d766">FreeInstance</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>);
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         <span class="keywordflow">if</span> (! b_Res)
<a name="l00204"></a>00204         {
<a name="l00205"></a>00205             <span class="comment">// Abort on error.</span>
<a name="l00206"></a>00206             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00207"></a>00207         }
<a name="l00208"></a>00208     }
<a name="l00209"></a>00209 
<a name="l00210"></a>00210     <span class="comment">// Store next reference.</span>
<a name="l00211"></a>00211     {
<a name="l00212"></a>00212         CLI_Stream.<a class="code" href="classOutputDevice.html#5cf7d389260e7c6a349efb9c2f5da262">UseInstance</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>);
<a name="l00213"></a>00213         <span class="keywordflow">if</span> (<a class="code" href="classShell.html#562d5552796bb86d3fcc5a3ce0680cf4">IsRunning</a>())
<a name="l00214"></a>00214         {
<a name="l00215"></a>00215             <span class="keywordflow">if</span> (! CLI_Stream.<a class="code" href="classOutputDevice.html#75099b653ab724583210d817dbf8b446">OpenUp</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>))
<a name="l00216"></a>00216             {
<a name="l00217"></a>00217                 <span class="comment">// Store nothing on error.</span>
<a name="l00218"></a>00218                 PrintError(<a class="code" href="classResourceString.html">ResourceString</a>(), CLI_Stream.<a class="code" href="classOutputDevice.html#1049ff5527f478db965a6629ebfd2f00">GetLastError</a>());
<a name="l00219"></a>00219                 CLI_Stream.<a class="code" href="classOutputDevice.html#ecfe1a98108afdbf1262c6a05ee7d766">FreeInstance</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>);
<a name="l00220"></a>00220                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00221"></a>00221             }
<a name="l00222"></a>00222         }
<a name="l00223"></a>00223         <span class="comment">// Do not store the reference until opening is done.</span>
<a name="l00224"></a>00224         m_artStream[E_StreamType].pcliStream = &amp; CLI_Stream;
<a name="l00225"></a>00225     }
<a name="l00226"></a>00226 
<a name="l00227"></a>00227     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00228"></a>00228 }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classShell.html#de17c6ad4098d8ce4fe9bf5bcc96f172">Shell::StreamEnabled</a>(<span class="keyword">const</span> <a class="code" href="shell_8h.html#8777d6765665b0c44a1caa09dc335fe3">STREAM_TYPE</a> E_StreamType)<span class="keyword"> const</span>
<a name="l00231"></a>00231 <span class="keyword"></span>{
<a name="l00232"></a>00232     <span class="keywordflow">if</span> ((E_StreamType &lt; 0) || (E_StreamType &gt;= STREAM_TYPES_COUNT))
<a name="l00233"></a>00233     {
<a name="l00234"></a>00234         <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(<span class="keyword">false</span>);
<a name="l00235"></a>00235         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00236"></a>00236     }
<a name="l00237"></a>00237     <span class="keywordflow">else</span>
<a name="l00238"></a>00238     {
<a name="l00239"></a>00239         <span class="keywordflow">return</span> m_artStream[E_StreamType].bEnable;
<a name="l00240"></a>00240     }
<a name="l00241"></a>00241 }
<a name="l00242"></a>00242 
<a name="l00243"></a>00243 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classShell.html#bf9b1288aa95e7a4668d43f6e4aa497d">Shell::EnableStream</a>(<span class="keyword">const</span> <a class="code" href="shell_8h.html#8777d6765665b0c44a1caa09dc335fe3">STREAM_TYPE</a> E_StreamType, <span class="keyword">const</span> <span class="keywordtype">bool</span> B_Enable)
<a name="l00244"></a>00244 {
<a name="l00245"></a>00245     <span class="comment">// ALL_STREAMS management.</span>
<a name="l00246"></a>00246     <span class="keywordflow">if</span> (E_StreamType == <a class="code" href="shell_8h.html#831be33be460d85af138038078ebd6464a3d58d84486a4d788ec5e59ccd21b27">ALL_STREAMS</a>)
<a name="l00247"></a>00247     {
<a name="l00248"></a>00248         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; STREAM_TYPES_COUNT; i++)
<a name="l00249"></a>00249         {
<a name="l00250"></a>00250             <span class="keywordflow">if</span> (! <a class="code" href="classShell.html#bf9b1288aa95e7a4668d43f6e4aa497d">EnableStream</a>((<a class="code" href="shell_8h.html#8777d6765665b0c44a1caa09dc335fe3">STREAM_TYPE</a>) i, B_Enable))
<a name="l00251"></a>00251             {
<a name="l00252"></a>00252                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00253"></a>00253             }
<a name="l00254"></a>00254         }
<a name="l00255"></a>00255 
<a name="l00256"></a>00256         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00257"></a>00257     }
<a name="l00258"></a>00258     <span class="keywordflow">if</span> ((E_StreamType &lt; 0) || (E_StreamType &gt;= STREAM_TYPES_COUNT))
<a name="l00259"></a>00259     {
<a name="l00260"></a>00260         <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(<span class="keyword">false</span>);
<a name="l00261"></a>00261         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00262"></a>00262     }
<a name="l00263"></a>00263     <span class="comment">// End of ALL_STREAMS management.</span>
<a name="l00264"></a>00264 
<a name="l00265"></a>00265     m_artStream[E_StreamType].bEnable = B_Enable;
<a name="l00266"></a>00266     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00267"></a>00267 }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269 <span class="keywordtype">void</span> <a class="code" href="classShell.html#8778b8def7fbd6df15c9e615530097d4">Shell::SetWelcomeMessage</a>(<span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a>&amp; CLI_WelcomeMessage)
<a name="l00270"></a>00270 {
<a name="l00271"></a>00271     m_cliWelcomeMessage = CLI_WelcomeMessage;
<a name="l00272"></a>00272 }
<a name="l00273"></a>00273 
<a name="l00274"></a>00274 <span class="keywordtype">void</span> <a class="code" href="classShell.html#e80179cef20af1e277ccec1d78d6b775">Shell::SetByeMessage</a>(<span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a>&amp; CLI_ByeMessage)
<a name="l00275"></a>00275 {
<a name="l00276"></a>00276     m_cliByeMessage = CLI_ByeMessage;
<a name="l00277"></a>00277 }
<a name="l00278"></a>00278 
<a name="l00279"></a>00279 <span class="keywordtype">void</span> <a class="code" href="classShell.html#f4e5a2eaa80d146926bcde65351a3e4d">Shell::SetPrompt</a>(<span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a>&amp; CLI_Prompt)
<a name="l00280"></a>00280 {
<a name="l00281"></a>00281     m_cliNoDefaultPrompt = CLI_Prompt;
<a name="l00282"></a>00282 }
<a name="l00283"></a>00283 
<a name="l00284"></a>00284 <span class="keywordtype">void</span> <a class="code" href="classShell.html#24051dbc899ff4149c49d16fa848cc6b">Shell::SetErrorFormatting</a>(<span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a>&amp; CLI_LocationPrefix, <span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a>&amp; CLI_ErrorPrefix, <span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a>&amp; CLI_ErrorSuffix)
<a name="l00285"></a>00285 {
<a name="l00286"></a>00286     m_cliErrorFormatting[0] = CLI_LocationPrefix;
<a name="l00287"></a>00287     m_cliErrorFormatting[1] = CLI_ErrorPrefix;
<a name="l00288"></a>00288     m_cliErrorFormatting[2] = CLI_ErrorSuffix;
<a name="l00289"></a>00289 }
<a name="l00290"></a>00290 
<a name="l00291"></a>00291 <span class="keywordtype">void</span> <a class="code" href="classShell.html#4da46821d20e0c7519dec0ad3e381c3a">Shell::SetLang</a>(<span class="keyword">const</span> <a class="code" href="classResourceString.html#88d585d899c8482aeb434571923739b3">ResourceString::LANG</a> E_Lang)
<a name="l00292"></a>00292 {
<a name="l00293"></a>00293     m_eLang = E_Lang;
<a name="l00294"></a>00294 }
<a name="l00295"></a>00295 
<a name="l00296"></a>00296 <span class="keyword">const</span> <a class="code" href="classResourceString.html#88d585d899c8482aeb434571923739b3">ResourceString::LANG</a> <a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">Shell::GetLang</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00297"></a>00297 <span class="keyword"></span>{
<a name="l00298"></a>00298     <span class="keywordflow">return</span> m_eLang;
<a name="l00299"></a>00299 }
<a name="l00300"></a>00300 
<a name="l00301"></a>00301 <span class="keywordtype">void</span> <a class="code" href="classShell.html#d14c863b1b25d88be7575e0ed6ee36ae">Shell::SetBeep</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> B_Enable)
<a name="l00302"></a>00302 {
<a name="l00303"></a>00303     m_bBeep = B_Enable;
<a name="l00304"></a>00304 }
<a name="l00305"></a>00305 
<a name="l00306"></a>00306 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classShell.html#0ac2a73a2b92fcdc38f682a6c2267590">Shell::GetBeep</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00307"></a>00307 <span class="keyword"></span>{
<a name="l00308"></a>00308     <span class="keywordflow">return</span> m_bBeep;
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a>00311 <span class="keywordtype">void</span> <a class="code" href="classShell.html#678c17eba603acfa45838a710b50a76c">Shell::Run</a>(<a class="code" href="classIODevice.html">IODevice</a>&amp; CLI_IODevice)
<a name="l00312"></a>00312 {
<a name="l00313"></a>00313     <span class="keywordflow">if</span> (StartExecution(CLI_IODevice))
<a name="l00314"></a>00314     {
<a name="l00315"></a>00315         <span class="keywordflow">if</span> (<a class="code" href="classMonoThreadDevice.html">MonoThreadDevice</a>* <span class="keyword">const</span> pcli_MTDevice = dynamic_cast&lt;MonoThreadDevice*&gt;(m_pcliInput))
<a name="l00316"></a>00316         {
<a name="l00317"></a>00317             <span class="comment">// Simply attach the shell and wait for characters to be input.</span>
<a name="l00318"></a>00318             pcli_MTDevice-&gt;AttachShell(*<span class="keyword">this</span>);
<a name="l00319"></a>00319         }
<a name="l00320"></a>00320         <span class="keywordflow">else</span>
<a name="l00321"></a>00321         {
<a name="l00322"></a>00322             MainLoop();
<a name="l00323"></a>00323             FinishExecution();
<a name="l00324"></a>00324         }
<a name="l00325"></a>00325     }
<a name="l00326"></a>00326     <span class="keywordflow">else</span>
<a name="l00327"></a>00327     {
<a name="l00328"></a>00328         FinishExecution();
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332 <span class="keyword">const</span> <span class="keywordtype">bool</span> Shell::StartExecution(<a class="code" href="classIODevice.html">IODevice</a>&amp; CLI_IODevice)
<a name="l00333"></a>00333 {
<a name="l00334"></a>00334     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(TRACE_SHELL) &lt;&lt; <span class="stringliteral">"Shell for CLI '"</span> &lt;&lt; <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">GetCli</a>().<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>() &lt;&lt; <span class="stringliteral">"' starts running."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00335"></a>00335     <span class="comment">// Open devices.</span>
<a name="l00336"></a>00336     <span class="keywordflow">if</span> (OpenDevices(CLI_IODevice))
<a name="l00337"></a>00337     {
<a name="l00338"></a>00338         <span class="comment">// Trace device management.</span>
<a name="l00339"></a>00339         m_bRestoreTracesOnFinish = <span class="keyword">false</span>;
<a name="l00340"></a>00340         <span class="keywordflow">if</span> (! <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().IsStreamSet())
<a name="l00341"></a>00341         {
<a name="l00342"></a>00342             <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#111bcade621537d1e5b960a4c1331223">SetStream</a>(CLI_IODevice);
<a name="l00343"></a>00343             m_bRestoreTracesOnFinish = <span class="keyword">true</span>;
<a name="l00344"></a>00344         }
<a name="l00345"></a>00345 
<a name="l00346"></a>00346         <span class="comment">// Check the CLI is the first menu.</span>
<a name="l00347"></a>00347         <span class="keywordflow">if</span> ((m_pcliCli != NULL) &amp;&amp; (m_qMenus.GetHead() == m_pcliCli))
<a name="l00348"></a>00348         {
<a name="l00349"></a>00349             <span class="comment">// Enter the shell.</span>
<a name="l00350"></a>00350             PromptWelcomeMessage();
<a name="l00351"></a>00351             PromptMenu();
<a name="l00352"></a>00352 
<a name="l00353"></a>00353             <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00354"></a>00354         }
<a name="l00355"></a>00355     }
<a name="l00356"></a>00356 
<a name="l00357"></a>00357     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00358"></a>00358 }
<a name="l00359"></a>00359 
<a name="l00360"></a>00360 <span class="keywordtype">void</span> Shell::MainLoop(<span class="keywordtype">void</span>)
<a name="l00361"></a>00361 {
<a name="l00362"></a>00362     <span class="comment">// While there are menus in the menu stack, it means we are still waiting for command lines.</span>
<a name="l00363"></a>00363     <span class="keywordflow">while</span> (! m_qMenus.IsEmpty())
<a name="l00364"></a>00364     {
<a name="l00365"></a>00365         <span class="keywordtype">bool</span> b_QuitShell = <span class="keyword">true</span>;
<a name="l00366"></a>00366 
<a name="l00367"></a>00367         <span class="keywordflow">if</span> ((m_eThreadSafeCmd != THREAD_SAFE_QUIT)      <span class="comment">// Thread safe processing.</span>
<a name="l00368"></a>00368             &amp;&amp; (m_pcliInput != NULL))
<a name="l00369"></a>00369         {
<a name="l00370"></a>00370             <span class="comment">// Get an input key.</span>
<a name="l00371"></a>00371             <span class="keyword">const</span> <a class="code" href="io__device_8h.html#90d295cf6b6bc9873c186cc8851147f8">KEY</a> e_Key = m_pcliInput-&gt;<a class="code" href="classIODevice.html#7bafac5c500746f742aa289f33e38feb">GetKey</a>();
<a name="l00372"></a>00372 
<a name="l00373"></a>00373             <span class="keywordflow">if</span> ((m_eThreadSafeCmd != THREAD_SAFE_QUIT)  <span class="comment">// Thread safe processing.</span>
<a name="l00374"></a>00374                 &amp;&amp; (e_Key != <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471e42682039e1a584113718465a202d0c0">NULL_KEY</a>))                 <span class="comment">// End of input.</span>
<a name="l00375"></a>00375             {
<a name="l00376"></a>00376                 <span class="comment">// Process the input key.</span>
<a name="l00377"></a>00377                 OnKey(e_Key);
<a name="l00378"></a>00378                 b_QuitShell = <span class="keyword">false</span>;
<a name="l00379"></a>00379             }
<a name="l00380"></a>00380         }
<a name="l00381"></a>00381 
<a name="l00382"></a>00382         <span class="keywordflow">if</span> (b_QuitShell)
<a name="l00383"></a>00383         {
<a name="l00384"></a>00384             <a class="code" href="classShell.html#3d082082d4a4ee56c6d4e82564ae868b">Quit</a>();
<a name="l00385"></a>00385         }
<a name="l00386"></a>00386     }
<a name="l00387"></a>00387 }
<a name="l00388"></a>00388 
<a name="l00389"></a>00389 <span class="keywordtype">void</span> Shell::OnMonoThreadKey(<a class="code" href="classMonoThreadDevice.html">MonoThreadDevice</a>&amp; CLI_Source, <span class="keyword">const</span> <a class="code" href="io__device_8h.html#90d295cf6b6bc9873c186cc8851147f8">KEY</a> E_KeyCode)
<a name="l00390"></a>00390 {
<a name="l00391"></a>00391     <span class="keywordtype">bool</span> b_QuitShell = <span class="keyword">true</span>;
<a name="l00392"></a>00392 
<a name="l00393"></a>00393     <span class="keywordflow">if</span> ((! m_qMenus.IsEmpty())                      <span class="comment">// Menu stack control.</span>
<a name="l00394"></a>00394                                                     <span class="comment">// If there are menus in the menu stack,</span>
<a name="l00395"></a>00395                                                     <span class="comment">// it means we are still waiting for command lines.</span>
<a name="l00396"></a>00396         &amp;&amp; (m_eThreadSafeCmd != THREAD_SAFE_QUIT)   <span class="comment">// Thread safe processing (should be useless in mono-thread).</span>
<a name="l00397"></a>00397         &amp;&amp; (E_KeyCode != <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471e42682039e1a584113718465a202d0c0">NULL_KEY</a>)                  <span class="comment">// End of input.</span>
<a name="l00398"></a>00398         &amp;&amp; (&amp; CLI_Source == m_pcliInput))           <span class="comment">// Input source control.</span>
<a name="l00399"></a>00399     {
<a name="l00400"></a>00400         <span class="comment">// Process the input key.</span>
<a name="l00401"></a>00401         OnKey(E_KeyCode);
<a name="l00402"></a>00402         b_QuitShell = <span class="keyword">false</span>;
<a name="l00403"></a>00403     }
<a name="l00404"></a>00404 
<a name="l00405"></a>00405     <span class="comment">// Possibly quit the shell depending on the input.</span>
<a name="l00406"></a>00406     <span class="keywordflow">if</span> (b_QuitShell)
<a name="l00407"></a>00407     {
<a name="l00408"></a>00408         <span class="comment">// Let's quit the shell.</span>
<a name="l00409"></a>00409         <a class="code" href="classShell.html#3d082082d4a4ee56c6d4e82564ae868b">Quit</a>();
<a name="l00410"></a>00410     }
<a name="l00411"></a>00411 
<a name="l00412"></a>00412     <span class="comment">// Eventually finish execution if needed.</span>
<a name="l00413"></a>00413     <span class="keywordflow">if</span> (m_qMenus.IsEmpty()                          <span class="comment">// Menu stack control.</span>
<a name="l00414"></a>00414                                                     <span class="comment">// If there are no menus left in the menu stack,</span>
<a name="l00415"></a>00415                                                     <span class="comment">// it means the thing is done.</span>
<a name="l00416"></a>00416         || (m_eThreadSafeCmd == THREAD_SAFE_QUIT))  <span class="comment">// Thread safe processing (should be useless in mono-thread).</span>
<a name="l00417"></a>00417     {
<a name="l00418"></a>00418         <span class="comment">// Detach the shell of the mono-thread device.</span>
<a name="l00419"></a>00419         CLI_Source.<a class="code" href="classMonoThreadDevice.html#bdec0834f1a0c302fab83c1fd4937f1e">DetachShell</a>(*<span class="keyword">this</span>);
<a name="l00420"></a>00420         <span class="comment">// Finish execution.</span>
<a name="l00421"></a>00421         FinishExecution();
<a name="l00422"></a>00422     }
<a name="l00423"></a>00423 }
<a name="l00424"></a>00424 
<a name="l00425"></a>00425 <span class="keyword">const</span> <span class="keywordtype">bool</span> Shell::FinishExecution(<span class="keywordtype">void</span>)
<a name="l00426"></a>00426 {
<a name="l00427"></a>00427     <span class="keywordtype">bool</span> b_Res = <span class="keyword">true</span>;
<a name="l00428"></a>00428 
<a name="l00429"></a>00429     <span class="comment">// Leave the shell.</span>
<a name="l00430"></a>00430     PromptByeMessage();
<a name="l00431"></a>00431 
<a name="l00432"></a>00432     <span class="comment">// Restore the CLI reference.</span>
<a name="l00433"></a>00433     <span class="keywordflow">if</span> (! m_qMenus.AddTail(m_pcliCli))
<a name="l00434"></a>00434     {
<a name="l00435"></a>00435         <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(<a class="code" href="traces_8h.html#243b1b1f8ca7e7e98ac73a2d115256f4">INTERNAL_ERROR</a>) &lt;&lt; <span class="stringliteral">"Could not restore a valid status on shell exit."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00436"></a>00436         b_Res = <span class="keyword">false</span>;
<a name="l00437"></a>00437     }
<a name="l00438"></a>00438 
<a name="l00439"></a>00439     <span class="comment">// Trace device management.</span>
<a name="l00440"></a>00440     <span class="keywordflow">if</span> (m_bRestoreTracesOnFinish)
<a name="l00441"></a>00441     {
<a name="l00442"></a>00442         <span class="keywordflow">if</span> (! <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().UnsetStream())
<a name="l00443"></a>00443         {
<a name="l00444"></a>00444             b_Res = <span class="keyword">false</span>;
<a name="l00445"></a>00445         }
<a name="l00446"></a>00446     }
<a name="l00447"></a>00447 
<a name="l00448"></a>00448     <span class="comment">// Close devices.</span>
<a name="l00449"></a>00449     <span class="keywordflow">if</span> (! CloseDevices())
<a name="l00450"></a>00450     {
<a name="l00451"></a>00451         b_Res = <span class="keyword">false</span>;
<a name="l00452"></a>00452     }
<a name="l00453"></a>00453     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(TRACE_SHELL) &lt;&lt; <span class="stringliteral">"Shell for CLI '"</span> &lt;&lt; <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">GetCli</a>().<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>() &lt;&lt; <span class="stringliteral">"' end of run."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00454"></a>00454 
<a name="l00455"></a>00455     <span class="keywordflow">return</span> b_Res;
<a name="l00456"></a>00456 }
<a name="l00457"></a>00457 
<a name="l00458"></a>00458 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="classShell.html#562d5552796bb86d3fcc5a3ce0680cf4">Shell::IsRunning</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00459"></a>00459 <span class="keyword"></span>{
<a name="l00460"></a>00460     <span class="keywordflow">return</span> (m_pcliInput != NULL);
<a name="l00461"></a>00461 }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classShell.html#88ecb7b84507a6a0a328bbad2f7dc546">Shell::GetHelpMargin</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00464"></a>00464 <span class="keyword"></span>{
<a name="l00465"></a>00465     <span class="keywordflow">return</span> HELP_MARGIN;
<a name="l00466"></a>00466 }
<a name="l00467"></a>00467 
<a name="l00468"></a>00468 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="classShell.html#b634fad29d7130768a0d035b4b84fa5c">Shell::GetHelpOffset</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00469"></a>00469 <span class="keyword"></span>{
<a name="l00470"></a>00470     <span class="keywordflow">return</span> HELP_OFFSET;
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a>00473 <span class="keyword">const</span> <span class="keywordtype">bool</span> Shell::OpenDevices(<a class="code" href="classIODevice.html">IODevice</a>&amp; CLI_IODevice)
<a name="l00474"></a>00474 {
<a name="l00475"></a>00475     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(TRACE_SHELL) &lt;&lt; <span class="stringliteral">"Shell for CLI '"</span> &lt;&lt; <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">GetCli</a>().<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>() &lt;&lt; <span class="stringliteral">"' opening devices."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00476"></a>00476 
<a name="l00477"></a>00477     <span class="keywordtype">bool</span> b_Res = <span class="keyword">true</span>;
<a name="l00478"></a>00478 
<a name="l00479"></a>00479     <span class="comment">// First of all, set references.</span>
<a name="l00480"></a>00480     {
<a name="l00481"></a>00481         <span class="comment">// Input.</span>
<a name="l00482"></a>00482         <span class="keywordflow">if</span> (m_pcliInput != NULL)
<a name="l00483"></a>00483         {
<a name="l00484"></a>00484             m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#ecfe1a98108afdbf1262c6a05ee7d766">FreeInstance</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>);
<a name="l00485"></a>00485             m_pcliInput = NULL;
<a name="l00486"></a>00486         }
<a name="l00487"></a>00487         m_pcliInput = &amp; CLI_IODevice;
<a name="l00488"></a>00488         m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#5cf7d389260e7c6a349efb9c2f5da262">UseInstance</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>);
<a name="l00489"></a>00489 
<a name="l00490"></a>00490         <span class="comment">// Output.</span>
<a name="l00491"></a>00491         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;STREAM_TYPES_COUNT; i++)
<a name="l00492"></a>00492         {
<a name="l00493"></a>00493             <span class="keywordflow">if</span> (m_artStream[i].pcliStream == NULL)
<a name="l00494"></a>00494             {
<a name="l00495"></a>00495                 m_artStream[i].pcliStream = &amp; CLI_IODevice;
<a name="l00496"></a>00496                 m_artStream[i].pcliStream-&gt;UseInstance(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>);
<a name="l00497"></a>00497             }
<a name="l00499"></a>00499             m_artStream[i].bEnable = <span class="keyword">true</span>;
<a name="l00500"></a>00500         }
<a name="l00501"></a>00501     }
<a name="l00502"></a>00502 
<a name="l00503"></a>00503     <span class="comment">// Then open up devices.</span>
<a name="l00504"></a>00504     {
<a name="l00505"></a>00505         <span class="comment">// Input.</span>
<a name="l00506"></a>00506         <span class="keywordflow">if</span> (m_pcliInput == NULL)
<a name="l00507"></a>00507         {
<a name="l00508"></a>00508             <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(<span class="keyword">false</span>);
<a name="l00509"></a>00509             b_Res = <span class="keyword">false</span>;
<a name="l00510"></a>00510         }
<a name="l00511"></a>00511         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#75099b653ab724583210d817dbf8b446">OpenUp</a>(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>))
<a name="l00512"></a>00512         {
<a name="l00513"></a>00513             PrintError(<a class="code" href="classResourceString.html">ResourceString</a>(), m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#1049ff5527f478db965a6629ebfd2f00">GetLastError</a>());
<a name="l00514"></a>00514             b_Res = <span class="keyword">false</span>;
<a name="l00515"></a>00515         }
<a name="l00516"></a>00516 
<a name="l00517"></a>00517         <span class="comment">// Output.</span>
<a name="l00518"></a>00518         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;STREAM_TYPES_COUNT; i++)
<a name="l00519"></a>00519         {
<a name="l00520"></a>00520             <span class="keywordflow">if</span> (m_artStream[i].pcliStream == NULL)
<a name="l00521"></a>00521             {
<a name="l00522"></a>00522                 <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(<span class="keyword">false</span>);
<a name="l00523"></a>00523                 b_Res = <span class="keyword">false</span>;
<a name="l00524"></a>00524             }
<a name="l00525"></a>00525             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! m_artStream[i].pcliStream-&gt;OpenUp(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>))
<a name="l00526"></a>00526             {
<a name="l00527"></a>00527                 PrintError(<a class="code" href="classResourceString.html">ResourceString</a>(), m_artStream[i].pcliStream-&gt;GetLastError());
<a name="l00528"></a>00528                 b_Res = <span class="keyword">false</span>;
<a name="l00529"></a>00529             }
<a name="l00530"></a>00530         }
<a name="l00531"></a>00531     }
<a name="l00532"></a>00532 
<a name="l00533"></a>00533     <span class="keywordflow">return</span> b_Res;
<a name="l00534"></a>00534 }
<a name="l00535"></a>00535 
<a name="l00536"></a>00536 <span class="keyword">const</span> <span class="keywordtype">bool</span> Shell::CloseDevices(<span class="keywordtype">void</span>)
<a name="l00537"></a>00537 {
<a name="l00538"></a>00538     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(TRACE_SHELL) &lt;&lt; <span class="stringliteral">"Shell for CLI '"</span> &lt;&lt; <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">GetCli</a>().<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>() &lt;&lt; <span class="stringliteral">"' closing devices."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00539"></a>00539 
<a name="l00540"></a>00540     <span class="keywordtype">bool</span> b_Res = <span class="keyword">true</span>;
<a name="l00541"></a>00541 
<a name="l00542"></a>00542     <span class="comment">// Close down devices.</span>
<a name="l00543"></a>00543     {
<a name="l00544"></a>00544         <span class="comment">// Output.</span>
<a name="l00545"></a>00545         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;STREAM_TYPES_COUNT; i++)
<a name="l00546"></a>00546         {
<a name="l00547"></a>00547             <span class="keywordflow">if</span> (m_artStream[i].pcliStream == NULL)
<a name="l00548"></a>00548             {
<a name="l00549"></a>00549                 <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(<span class="keyword">false</span>);
<a name="l00550"></a>00550                 b_Res = <span class="keyword">false</span>;
<a name="l00551"></a>00551             }
<a name="l00552"></a>00552             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! m_artStream[i].pcliStream-&gt;CloseDown(<a class="code" href="debug_8h.html#12506d620d4ecd0161866c9b19d761ed">__CALL_INFO__</a>))
<a name="l00553"></a>00553             {
<a name="l00554"></a>00554                 PrintError(<a class="code" href="classResourceString.html">ResourceString</a>(), m_artStream[i].pcliStream-&gt;GetLastError());
<a name="l00555"></a>00555                 b_Res = <span class="keyword">false</span>;
<a name="l00556"></a>00556             }
<a name="l00557"></a>00557         }
<a name="l00558"></a>00558 
<a name="l00559"></a>00559         <span class="comment">// Input device.</span>
<a name="l00560"></a>00560         <span class="keywordflow">if</span> (m_pcliInput == NULL)
<a name="l00561"></a>00561         {
<a name="l00562"></a>00562             <a class="code" href="assert_8h.html#1fe8f84b5d89ceccc07361b1d0da0144">CLI_ASSERT</a>(<span class="keyword">false</span>);
<a name="l00563"></a>00563             b_Res = <span class="keyword">false</span>;
<a name="l00564"></a>00564         }
<a name="l00565"></a>00565         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (! m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#810d944acedbf6fa139fb852ff547957">CloseDown</a>(__CALL_INFO__))
<a name="l00566"></a>00566         {
<a name="l00567"></a>00567             PrintError(<a class="code" href="classResourceString.html">ResourceString</a>(), m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#1049ff5527f478db965a6629ebfd2f00">GetLastError</a>());
<a name="l00568"></a>00568             b_Res = <span class="keyword">false</span>;
<a name="l00569"></a>00569         }
<a name="l00570"></a>00570     }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572     <span class="comment">// Unset references.</span>
<a name="l00573"></a>00573     {
<a name="l00574"></a>00574         <span class="comment">// Output.</span>
<a name="l00575"></a>00575         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;STREAM_TYPES_COUNT; i++)
<a name="l00576"></a>00576         {
<a name="l00577"></a>00577             <span class="keywordflow">if</span> (m_artStream[i].pcliStream == m_pcliInput)
<a name="l00578"></a>00578             {
<a name="l00579"></a>00579                 <span class="keywordflow">if</span> (! m_artStream[i].pcliStream-&gt;FreeInstance(__CALL_INFO__))
<a name="l00580"></a>00580                 {
<a name="l00581"></a>00581                     PrintError(<a class="code" href="classResourceString.html">ResourceString</a>(), m_artStream[i].pcliStream-&gt;GetLastError());
<a name="l00582"></a>00582                     b_Res = <span class="keyword">false</span>;
<a name="l00583"></a>00583                 }
<a name="l00584"></a>00584                 m_artStream[i].pcliStream = NULL;
<a name="l00585"></a>00585             }
<a name="l00586"></a>00586         }
<a name="l00587"></a>00587 
<a name="l00588"></a>00588         <span class="comment">// Input.</span>
<a name="l00589"></a>00589         <span class="keywordflow">if</span> (m_pcliInput != NULL)
<a name="l00590"></a>00590         {
<a name="l00591"></a>00591             <span class="keywordflow">if</span> (! m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#ecfe1a98108afdbf1262c6a05ee7d766">FreeInstance</a>(__CALL_INFO__))
<a name="l00592"></a>00592             {
<a name="l00593"></a>00593                 PrintError(<a class="code" href="classResourceString.html">ResourceString</a>(), m_pcliInput-&gt;<a class="code" href="classOutputDevice.html#1049ff5527f478db965a6629ebfd2f00">GetLastError</a>());
<a name="l00594"></a>00594                 b_Res = <span class="keyword">false</span>;
<a name="l00595"></a>00595             }
<a name="l00596"></a>00596             m_pcliInput = NULL;
<a name="l00597"></a>00597         }
<a name="l00598"></a>00598     }
<a name="l00599"></a>00599 
<a name="l00600"></a>00600     <span class="keywordflow">return</span> b_Res;
<a name="l00601"></a>00601 }
<a name="l00602"></a>00602 
<a name="l00603"></a>00603 <span class="keywordtype">void</span> Shell::PromptWelcomeMessage(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00604"></a>00604 <span class="keyword"></span>{
<a name="l00605"></a>00605     <span class="keyword">const</span> tk::String str_WelcomeMessage = m_cliWelcomeMessage.<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>());
<a name="l00606"></a>00606     <span class="keywordflow">if</span> (! str_WelcomeMessage.IsEmpty())
<a name="l00607"></a>00607     {
<a name="l00608"></a>00608         <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd6465947dfbf1d626b225b608bd19613abe0">WELCOME_STREAM</a>) &lt;&lt; str_WelcomeMessage;
<a name="l00609"></a>00609     }
<a name="l00610"></a>00610     <span class="keywordflow">else</span>
<a name="l00611"></a>00611     {
<a name="l00612"></a>00612         <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd6465947dfbf1d626b225b608bd19613abe0">WELCOME_STREAM</a>)
<a name="l00613"></a>00613         &lt;&lt; <span class="stringliteral">"---------------------------------------------------"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>
<a name="l00614"></a>00614         &lt;&lt; <span class="stringliteral">" Welcome to "</span> &lt;&lt; <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">GetCli</a>().<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>() &lt;&lt; <span class="stringliteral">"!"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>
<a name="l00615"></a>00615         &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>
<a name="l00616"></a>00616         &lt;&lt; <span class="stringliteral">" "</span> &lt;&lt; <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">GetCli</a>().<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>() &lt;&lt; <span class="stringliteral">" is a command line interface"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>
<a name="l00617"></a>00617         &lt;&lt; <span class="stringliteral">" using the CLI library"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>
<a name="l00618"></a>00618         &lt;&lt; <span class="stringliteral">"   (c) Alexis Royer http://alexis.royer.free.fr/CLI/"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>
<a name="l00619"></a>00619         &lt;&lt; <span class="stringliteral">" Type 'help' at any time"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>
<a name="l00620"></a>00620         &lt;&lt; <span class="stringliteral">" or press '?' or TAB to get completion or help."</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>
<a name="l00621"></a>00621         &lt;&lt; <span class="stringliteral">"---------------------------------------------------"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623 }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625 <span class="keywordtype">void</span> Shell::PromptByeMessage(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00626"></a>00626 <span class="keyword"></span>{
<a name="l00627"></a>00627     <span class="keyword">const</span> tk::String str_ByeMessage = m_cliByeMessage.<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>());
<a name="l00628"></a>00628     <span class="keywordflow">if</span> (! str_ByeMessage.IsEmpty())
<a name="l00629"></a>00629     {
<a name="l00630"></a>00630         <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd6465947dfbf1d626b225b608bd19613abe0">WELCOME_STREAM</a>) &lt;&lt; str_ByeMessage;
<a name="l00631"></a>00631     }
<a name="l00632"></a>00632     <span class="keywordflow">else</span>
<a name="l00633"></a>00633     {
<a name="l00634"></a>00634         <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd6465947dfbf1d626b225b608bd19613abe0">WELCOME_STREAM</a>) &lt;&lt; <span class="stringliteral">"Bye!"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00635"></a>00635     }
<a name="l00636"></a>00636 }
<a name="l00637"></a>00637 
<a name="l00638"></a>00638 <span class="keywordtype">void</span> Shell::PromptMenu(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00639"></a>00639 <span class="keyword"></span>{
<a name="l00640"></a>00640     <span class="comment">// Show the prompt.</span>
<a name="l00641"></a>00641     <span class="keywordflow">if</span> (! m_qMenus.IsEmpty())
<a name="l00642"></a>00642     {
<a name="l00643"></a>00643         <span class="keyword">const</span> tk::String str_NoDefaultPrompt = m_cliNoDefaultPrompt.<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>());
<a name="l00644"></a>00644         <span class="keywordflow">if</span> (! str_NoDefaultPrompt.IsEmpty())
<a name="l00645"></a>00645         {
<a name="l00646"></a>00646             <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd64657c744739e5f87c99f41fb01fb794b42">PROMPT_STREAM</a>) &lt;&lt; str_NoDefaultPrompt;
<a name="l00647"></a>00647         }
<a name="l00648"></a>00648         <span class="keywordflow">else</span>
<a name="l00649"></a>00649         {
<a name="l00650"></a>00650             <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classMenu.html">Menu</a>* <span class="keyword">const</span> pcli_Menu = m_qMenus.GetTail())
<a name="l00651"></a>00651             {
<a name="l00652"></a>00652                 <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd64657c744739e5f87c99f41fb01fb794b42">PROMPT_STREAM</a>) &lt;&lt; pcli_Menu-&gt;GetKeyword() &lt;&lt; <span class="stringliteral">"&gt;"</span>;
<a name="l00653"></a>00653             }
<a name="l00654"></a>00654         }
<a name="l00655"></a>00655 
<a name="l00656"></a>00656         <span class="comment">// Eventually echo the current line.</span>
<a name="l00657"></a>00657         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#048465c667e3c9e7ae8967d8772c9b50">PrintCmdLine</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>));
<a name="l00658"></a>00658     }
<a name="l00659"></a>00659 }
<a name="l00660"></a>00660 
<a name="l00661"></a>00661 <span class="keywordtype">void</span> Shell::PrintError(<span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a>&amp; CLI_Location, <span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a>&amp; CLI_ErrorMessage)<span class="keyword"> const</span>
<a name="l00662"></a>00662 <span class="keyword"></span>{
<a name="l00663"></a>00663     <span class="comment">// First of all, call the CLI handler.</span>
<a name="l00664"></a>00664     <a class="code" href="classShell.html#beaf5cf204bacd7c13266ec1a7f9006a">GetCli</a>().<a class="code" href="classCli.html#61e2c000d188f271617ca2bb3c87aa2a">OnError</a>(CLI_Location, CLI_ErrorMessage);
<a name="l00665"></a>00665 
<a name="l00666"></a>00666     <span class="comment">// Retrieve error formatting prefix and suffix.</span>
<a name="l00667"></a>00667     <span class="keyword">const</span> tk::String str_LocationPrefix = m_cliErrorFormatting[0].<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>());
<a name="l00668"></a>00668     <span class="keyword">const</span> tk::String str_ErrorPrefix = m_cliErrorFormatting[1].<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>());
<a name="l00669"></a>00669     <span class="keyword">const</span> tk::String str_ErrorSuffix = m_cliErrorFormatting[2].<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>());
<a name="l00670"></a>00670 
<a name="l00671"></a>00671     <span class="comment">// Print out the error.</span>
<a name="l00672"></a>00672     <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd64653988cedf87c54e9e5dcc0e79f86db8e">ERROR_STREAM</a>)
<a name="l00673"></a>00673         &lt;&lt; str_LocationPrefix
<a name="l00674"></a>00674         &lt;&lt; CLI_Location.<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>())
<a name="l00675"></a>00675         &lt;&lt; str_ErrorPrefix
<a name="l00676"></a>00676         &lt;&lt; CLI_ErrorMessage.<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>())
<a name="l00677"></a>00677         &lt;&lt; str_ErrorSuffix
<a name="l00678"></a>00678         &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00679"></a>00679 }
<a name="l00680"></a>00680 
<a name="l00681"></a>00681 <span class="keywordtype">void</span> <a class="code" href="classShell.html#b244951b902a334a0b042d48af9989fd">Shell::ExitMenu</a>(<span class="keywordtype">void</span>)
<a name="l00682"></a>00682 {
<a name="l00683"></a>00683     <span class="keyword">const</span> tk::String tk_Left = m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#82e777328c85d7de1c5cdc491c958d13">GetLeft</a>(), tk_Right = m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#3e939f8bc49e7e4be75e24dc170f6c44">GetRight</a>();
<a name="l00684"></a>00684     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#55c26585a8b2ef1c7540dd26e4ab26f1">Reset</a>();
<a name="l00685"></a>00685     OnExit(<span class="keyword">false</span>);
<a name="l00686"></a>00686     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#69eacc8587f58b7ca149df2ef0a46ccb">Set</a>(tk_Left, tk_Right);
<a name="l00687"></a>00687 }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689 <span class="keywordtype">void</span> <a class="code" href="classShell.html#3d082082d4a4ee56c6d4e82564ae868b">Shell::Quit</a>(<span class="keywordtype">void</span>)
<a name="l00690"></a>00690 {
<a name="l00691"></a>00691     <span class="comment">// Remove all menus of the menu stack to let the shell quit.</span>
<a name="l00692"></a>00692     <span class="keywordflow">while</span> (! m_qMenus.IsEmpty())
<a name="l00693"></a>00693     {
<a name="l00694"></a>00694         <a class="code" href="classShell.html#b244951b902a334a0b042d48af9989fd">ExitMenu</a>();
<a name="l00695"></a>00695     }
<a name="l00696"></a>00696 }
<a name="l00697"></a>00697 
<a name="l00698"></a>00698 <span class="keywordtype">void</span> <a class="code" href="classShell.html#14b1f93386a3f66d65beec6fbbd80a20">Shell::QuitThreadSafe</a>(<span class="keywordtype">void</span>)
<a name="l00699"></a>00699 {
<a name="l00700"></a>00700     m_eThreadSafeCmd = THREAD_SAFE_QUIT;
<a name="l00701"></a>00701 }
<a name="l00702"></a>00702 
<a name="l00703"></a>00703 <span class="keywordtype">void</span> <a class="code" href="classShell.html#10d22c619c06ef903ffde6153cf7ec1e">Shell::DisplayHelp</a>(<span class="keywordtype">void</span>)
<a name="l00704"></a>00704 {
<a name="l00705"></a>00705     <span class="keywordflow">if</span> (! m_qMenus.IsEmpty())
<a name="l00706"></a>00706     {
<a name="l00707"></a>00707         <span class="keyword">const</span> tk::String tk_Left = m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#82e777328c85d7de1c5cdc491c958d13">GetLeft</a>(), tk_Right = m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#3e939f8bc49e7e4be75e24dc170f6c44">GetRight</a>();
<a name="l00708"></a>00708         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#55c26585a8b2ef1c7540dd26e4ab26f1">Reset</a>();
<a name="l00709"></a>00709         OnHelp(<span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l00710"></a>00710         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#69eacc8587f58b7ca149df2ef0a46ccb">Set</a>(tk_Left, tk_Right);
<a name="l00711"></a>00711     }
<a name="l00712"></a>00712 }
<a name="l00713"></a>00713 
<a name="l00714"></a>00714 <span class="keywordtype">void</span> <a class="code" href="classShell.html#9e18d5399d3855c50f1d54015e09bc86">Shell::PrintWorkingMenu</a>(<span class="keywordtype">void</span>)
<a name="l00715"></a>00715 {
<a name="l00716"></a>00716     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
<a name="l00717"></a>00717     <span class="keywordflow">for</span> (i=0; i&lt;HELP_MARGIN; i++)
<a name="l00718"></a>00718     {
<a name="l00719"></a>00719         <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>) &lt;&lt; <span class="stringliteral">" "</span>;
<a name="l00720"></a>00720     }
<a name="l00721"></a>00721     <span class="keywordflow">for</span> (   tk::Queue&lt;const Menu*&gt;::Iterator it = m_qMenus.GetIterator();
<a name="l00722"></a>00722             m_qMenus.IsValid(it);
<a name="l00723"></a>00723             m_qMenus.MoveNext(it))
<a name="l00724"></a>00724     {
<a name="l00725"></a>00725         <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classMenu.html">Menu</a>* <span class="keyword">const</span> pcli_Menu = m_qMenus.GetAt(it))
<a name="l00726"></a>00726         {
<a name="l00727"></a>00727             <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>) &lt;&lt; <span class="stringliteral">"/"</span> &lt;&lt; pcli_Menu-&gt;GetKeyword();
<a name="l00728"></a>00728         }
<a name="l00729"></a>00729     }
<a name="l00730"></a>00730     <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>) &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00733"></a>00733 <span class="keywordtype">void</span> Shell::EnterMenu(<span class="keyword">const</span> <a class="code" href="classMenu.html">Menu</a>&amp; CLI_Menu)
<a name="l00734"></a>00734 {
<a name="l00735"></a>00735     <span class="keywordflow">if</span> (! m_qMenus.AddTail(&amp; CLI_Menu))
<a name="l00736"></a>00736     {
<a name="l00737"></a>00737         <a class="code" href="classResourceString.html">ResourceString</a> cli_Error = <a class="code" href="classResourceString.html">ResourceString</a>()
<a name="l00738"></a>00738             .SetString(<a class="code" href="classResourceString.html#88d585d899c8482aeb434571923739b3f12fbeaebaa487c3970ecc2cf837e0df">ResourceString::LANG_EN</a>, tk::String::Concat(MAX_RESOURCE_LENGTH, <span class="stringliteral">"Too many menus. Cannot enter '"</span>, CLI_Menu.<a class="code" href="classMenu.html#37410d39de4348eee3c811af1a3774cd">GetName</a>(), <span class="stringliteral">"'."</span>))
<a name="l00739"></a>00739             .SetString(<a class="code" href="classResourceString.html#88d585d899c8482aeb434571923739b3142a22fb5f61fe5c723693b4cc887f4f">ResourceString::LANG_FR</a>, tk::String::Concat(MAX_RESOURCE_LENGTH, <span class="stringliteral">"Trop de menus. Impossible d'entrer dans le menu '"</span>, CLI_Menu.<a class="code" href="classMenu.html#37410d39de4348eee3c811af1a3774cd">GetName</a>(), <span class="stringliteral">"'."</span>));
<a name="l00740"></a>00740         PrintError(
<a name="l00741"></a>00741             (m_pcliInput != NULL) ? m_pcliInput-&gt;<a class="code" href="classIODevice.html#803bd02bf68fcbb8b40b50548b1cfb8b">GetLocation</a>() : <a class="code" href="classResourceString.html">ResourceString</a>(),
<a name="l00742"></a>00742             cli_Error
<a name="l00743"></a>00743         );
<a name="l00744"></a>00744     }
<a name="l00745"></a>00745     <span class="comment">//  PromptMenu();</span>
<a name="l00746"></a>00746 }
<a name="l00747"></a>00747 
<a name="l00748"></a>00748 <span class="keywordtype">void</span> Shell::OnKey(<span class="keyword">const</span> <a class="code" href="io__device_8h.html#90d295cf6b6bc9873c186cc8851147f8">KEY</a> E_KeyCode)
<a name="l00749"></a>00749 {
<a name="l00750"></a>00750     <span class="comment">// In general, history navigation is lost.</span>
<a name="l00751"></a>00751     <span class="comment">// Except for navigation keys, in history, and within the line.</span>
<a name="l00752"></a>00752     <span class="keywordflow">switch</span> (E_KeyCode)
<a name="l00753"></a>00753     {
<a name="l00754"></a>00754     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704710848a442d907968b211b97bc2bd88acd">KEY_UP</a>: <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471a9cdac7967bf7d88fdb761138a2a3416">KEY_DOWN</a>: <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704710442824c041b9618cd7c512205e7e6dc">PAGE_UP</a>: <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471714c5d27586a8bcbab274d9176da1539">PAGE_DOWN</a>:
<a name="l00755"></a>00755     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471eed3bac3a74a2eaf9a84d1a9774b67c1">KEY_BEGIN</a>: <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471a8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>: <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471612120b69c7dfd46086db7aaebdbcf65">KEY_LEFT</a>: <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704716504370d9c6391e1a9da6a1a529b089d">KEY_RIGHT</a>:
<a name="l00756"></a>00756         <span class="keywordflow">break</span>;
<a name="l00757"></a>00757     <span class="keywordflow">default</span>:
<a name="l00758"></a>00758         m_cliHistory.<a class="code" href="classCmdLineHistory.html#f332213fc831185cafb9a0bb1b8b8c37">EnableNavigationMemory</a>(<span class="keyword">false</span>);
<a name="l00759"></a>00759         <span class="keywordflow">break</span>;
<a name="l00760"></a>00760     }
<a name="l00761"></a>00761 
<a name="l00762"></a>00762     <span class="keywordflow">switch</span> (E_KeyCode)
<a name="l00763"></a>00763     {
<a name="l00764"></a>00764     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704710848a442d907968b211b97bc2bd88acd">KEY_UP</a>:    OnHistory(1);                           <span class="keywordflow">break</span>;
<a name="l00765"></a>00765     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471a9cdac7967bf7d88fdb761138a2a3416">KEY_DOWN</a>:  OnHistory(-1);                          <span class="keywordflow">break</span>;
<a name="l00766"></a>00766     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704710442824c041b9618cd7c512205e7e6dc">PAGE_UP</a>:   OnHistory(HISTORY_PAGE);                <span class="keywordflow">break</span>;
<a name="l00767"></a>00767     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471714c5d27586a8bcbab274d9176da1539">PAGE_DOWN</a>: OnHistory(- (<span class="keywordtype">signed</span> <span class="keywordtype">int</span>) HISTORY_PAGE); <span class="keywordflow">break</span>;
<a name="l00768"></a>00768     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471eed3bac3a74a2eaf9a84d1a9774b67c1">KEY_BEGIN</a>: OnKeyBegin();                           <span class="keywordflow">break</span>;
<a name="l00769"></a>00769     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471a8adb6fcb92dec58fb19410eacfdd403">KEY_END</a>:   OnKeyEnd();                             <span class="keywordflow">break</span>;
<a name="l00770"></a>00770     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471612120b69c7dfd46086db7aaebdbcf65">KEY_LEFT</a>:  OnKeyLeft();                            <span class="keywordflow">break</span>;
<a name="l00771"></a>00771     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704716504370d9c6391e1a9da6a1a529b089d">KEY_RIGHT</a>: OnKeyRight();                           <span class="keywordflow">break</span>;
<a name="l00772"></a>00772     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471d2534cebcf6f430484b7c931dd657ddc">BACKSPACE</a>: OnBackspace();                          <span class="keywordflow">break</span>;
<a name="l00773"></a>00773     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704719d61e82a9a12752f10aece1b22183913">DELETE</a>:    OnSuppr();                              <span class="keywordflow">break</span>;
<a name="l00774"></a>00774     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471951ab68bb8f7daafb78951107080904e">ENTER</a>:     OnExecute();                            <span class="keywordflow">break</span>;
<a name="l00775"></a>00775     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704719524d094809858b9e4f778763913568a">BREAK</a>:
<a name="l00776"></a>00776     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc2704710a311695a4f6c56869245418bebeb33d">ESCAPE</a>:    OnEscape();                             <span class="keywordflow">break</span>;
<a name="l00777"></a>00777     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc27047186d6ca369e69a3a0f0c9bd063dd39a70">LOGOUT</a>:    OnExit(<span class="keyword">true</span>);                           <span class="keywordflow">break</span>;
<a name="l00778"></a>00778     <span class="keywordflow">case</span> TAB:       OnHelp(<span class="keyword">true</span>, <span class="keyword">false</span>);                    <span class="keywordflow">break</span>;
<a name="l00779"></a>00779     <span class="keywordflow">case</span> QUESTION:
<a name="l00780"></a>00780         <span class="keywordflow">if</span> (m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#59decc58f0539006c8e816f2268cf11e">GetLine</a>().GetChar(m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#59decc58f0539006c8e816f2268cf11e">GetLine</a>().GetLength() - 1) == <span class="charliteral">'\\'</span>)
<a name="l00781"></a>00781             OnPrintableChar(E_KeyCode);
<a name="l00782"></a>00782         <span class="keywordflow">else</span>
<a name="l00783"></a>00783             OnHelp(<span class="keyword">true</span>, <span class="keyword">true</span>);
<a name="l00784"></a>00784         <span class="keywordflow">break</span>;
<a name="l00785"></a>00785     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471a5e0d06ffc1b0ee32eda539e6528a3e6">CLS</a>:       OnCleanScreen();                        <span class="keywordflow">break</span>;
<a name="l00786"></a>00786 
<a name="l00787"></a>00787     <span class="keywordflow">case</span> KEY_a: <span class="keywordflow">case</span> KEY_aacute: <span class="keywordflow">case</span> KEY_agrave: <span class="keywordflow">case</span> KEY_auml: <span class="keywordflow">case</span> KEY_acirc:
<a name="l00788"></a>00788     <span class="keywordflow">case</span> KEY_b: <span class="keywordflow">case</span> KEY_c: <span class="keywordflow">case</span> KEY_ccedil: <span class="keywordflow">case</span> KEY_d:
<a name="l00789"></a>00789     <span class="keywordflow">case</span> KEY_e: <span class="keywordflow">case</span> KEY_eacute: <span class="keywordflow">case</span> KEY_egrave: <span class="keywordflow">case</span> KEY_euml: <span class="keywordflow">case</span> KEY_ecirc:
<a name="l00790"></a>00790     <span class="keywordflow">case</span> KEY_f: <span class="keywordflow">case</span> KEY_g: <span class="keywordflow">case</span> KEY_h:
<a name="l00791"></a>00791     <span class="keywordflow">case</span> KEY_i: <span class="keywordflow">case</span> KEY_iacute: <span class="keywordflow">case</span> KEY_igrave: <span class="keywordflow">case</span> KEY_iuml: <span class="keywordflow">case</span> KEY_icirc:
<a name="l00792"></a>00792     <span class="keywordflow">case</span> KEY_j: <span class="keywordflow">case</span> KEY_k: <span class="keywordflow">case</span> KEY_l: <span class="keywordflow">case</span> KEY_m: <span class="keywordflow">case</span> KEY_n:
<a name="l00793"></a>00793     <span class="keywordflow">case</span> KEY_o: <span class="keywordflow">case</span> KEY_oacute: <span class="keywordflow">case</span> KEY_ograve: <span class="keywordflow">case</span> KEY_ouml: <span class="keywordflow">case</span> KEY_ocirc:
<a name="l00794"></a>00794     <span class="keywordflow">case</span> KEY_p: <span class="keywordflow">case</span> KEY_q: <span class="keywordflow">case</span> KEY_r: <span class="keywordflow">case</span> KEY_s: <span class="keywordflow">case</span> KEY_t:
<a name="l00795"></a>00795     <span class="keywordflow">case</span> KEY_u: <span class="keywordflow">case</span> KEY_uacute: <span class="keywordflow">case</span> KEY_ugrave: <span class="keywordflow">case</span> KEY_uuml: <span class="keywordflow">case</span> KEY_ucirc:
<a name="l00796"></a>00796     <span class="keywordflow">case</span> KEY_v: <span class="keywordflow">case</span> KEY_w: <span class="keywordflow">case</span> KEY_x: <span class="keywordflow">case</span> KEY_y: <span class="keywordflow">case</span> KEY_z:
<a name="l00797"></a>00797 
<a name="l00798"></a>00798     <span class="keywordflow">case</span> KEY_A: <span class="keywordflow">case</span> KEY_B: <span class="keywordflow">case</span> KEY_C: <span class="keywordflow">case</span> KEY_D: <span class="keywordflow">case</span> KEY_E: <span class="keywordflow">case</span> KEY_F:
<a name="l00799"></a>00799     <span class="keywordflow">case</span> KEY_G: <span class="keywordflow">case</span> KEY_H: <span class="keywordflow">case</span> KEY_I: <span class="keywordflow">case</span> KEY_J: <span class="keywordflow">case</span> KEY_K: <span class="keywordflow">case</span> KEY_L:
<a name="l00800"></a>00800     <span class="keywordflow">case</span> KEY_M: <span class="keywordflow">case</span> KEY_N: <span class="keywordflow">case</span> KEY_O: <span class="keywordflow">case</span> KEY_P: <span class="keywordflow">case</span> KEY_Q: <span class="keywordflow">case</span> KEY_R:
<a name="l00801"></a>00801     <span class="keywordflow">case</span> KEY_S: <span class="keywordflow">case</span> KEY_T: <span class="keywordflow">case</span> KEY_U: <span class="keywordflow">case</span> KEY_V: <span class="keywordflow">case</span> KEY_W: <span class="keywordflow">case</span> KEY_X:
<a name="l00802"></a>00802     <span class="keywordflow">case</span> KEY_Y: <span class="keywordflow">case</span> KEY_Z:
<a name="l00803"></a>00803 
<a name="l00804"></a>00804     <span class="keywordflow">case</span> KEY_0: <span class="keywordflow">case</span> KEY_1: <span class="keywordflow">case</span> KEY_2: <span class="keywordflow">case</span> KEY_3: <span class="keywordflow">case</span> KEY_4: <span class="keywordflow">case</span> KEY_5:
<a name="l00805"></a>00805     <span class="keywordflow">case</span> KEY_6: <span class="keywordflow">case</span> KEY_7: <span class="keywordflow">case</span> KEY_8: <span class="keywordflow">case</span> KEY_9:
<a name="l00806"></a>00806 
<a name="l00807"></a>00807     <span class="keywordflow">case</span> PLUS:
<a name="l00808"></a>00808     <span class="keywordflow">case</span> MINUS:
<a name="l00809"></a>00809     <span class="keywordflow">case</span> STAR:
<a name="l00810"></a>00810     <span class="keywordflow">case</span> SLASH:
<a name="l00811"></a>00811     <span class="keywordflow">case</span> LOWER_THAN:
<a name="l00812"></a>00812     <span class="keywordflow">case</span> GREATER_THAN:
<a name="l00813"></a>00813     <span class="keywordflow">case</span> EQUAL:
<a name="l00814"></a>00814     <span class="keywordflow">case</span> PERCENT:
<a name="l00815"></a>00815 
<a name="l00816"></a>00816     <span class="keywordflow">case</span> <a class="code" href="io__device_8h.html#87c1c1677bb8199c62a3de0ebc270471c08dae7edcb5c5bb959fee5971fbad95">SPACE</a>:
<a name="l00817"></a>00817     <span class="keywordflow">case</span> UNDERSCORE:
<a name="l00818"></a>00818     <span class="keywordflow">case</span> AROBASE:
<a name="l00819"></a>00819     <span class="keywordflow">case</span> SHARP:
<a name="l00820"></a>00820     <span class="keywordflow">case</span> AMPERCENT:
<a name="l00821"></a>00821     <span class="keywordflow">case</span> DOLLAR:
<a name="l00822"></a>00822     <span class="keywordflow">case</span> BACKSLASH:
<a name="l00823"></a>00823     <span class="keywordflow">case</span> PIPE:
<a name="l00824"></a>00824     <span class="keywordflow">case</span> TILDE:
<a name="l00825"></a>00825     <span class="keywordflow">case</span> SQUARE:
<a name="l00826"></a>00826     <span class="keywordflow">case</span> EURO:
<a name="l00827"></a>00827     <span class="keywordflow">case</span> POUND:
<a name="l00828"></a>00828     <span class="keywordflow">case</span> MICRO:
<a name="l00829"></a>00829     <span class="keywordflow">case</span> PARAGRAPH:
<a name="l00830"></a>00830 
<a name="l00831"></a>00831     <span class="keywordflow">case</span> EXCLAMATION:
<a name="l00832"></a>00832     <span class="keywordflow">case</span> COLUMN:
<a name="l00833"></a>00833     <span class="keywordflow">case</span> DOT:
<a name="l00834"></a>00834     <span class="keywordflow">case</span> COMA:
<a name="l00835"></a>00835     <span class="keywordflow">case</span> SEMI_COLUMN:
<a name="l00836"></a>00836     <span class="keywordflow">case</span> QUOTE:
<a name="l00837"></a>00837     <span class="keywordflow">case</span> DOUBLE_QUOTE:
<a name="l00838"></a>00838 
<a name="l00839"></a>00839     <span class="keywordflow">case</span> OPENING_BRACE:
<a name="l00840"></a>00840     <span class="keywordflow">case</span> CLOSING_BRACE:
<a name="l00841"></a>00841     <span class="keywordflow">case</span> OPENING_CURLY_BRACE:
<a name="l00842"></a>00842     <span class="keywordflow">case</span> CLOSING_CURLY_BRACE:
<a name="l00843"></a>00843     <span class="keywordflow">case</span> OPENING_BRACKET:
<a name="l00844"></a>00844     <span class="keywordflow">case</span> CLOSING_BRACKET:
<a name="l00845"></a>00845         OnPrintableChar(E_KeyCode);
<a name="l00846"></a>00846         <span class="keywordflow">break</span>;
<a name="l00847"></a>00847 
<a name="l00848"></a>00848     <span class="keywordflow">default</span>:
<a name="l00849"></a>00849         <span class="comment">// Non managed character. Just ignore.</span>
<a name="l00850"></a>00850         <span class="keywordflow">break</span>;
<a name="l00851"></a>00851     }
<a name="l00852"></a>00852 }
<a name="l00853"></a>00853 
<a name="l00854"></a>00854 <span class="keywordtype">void</span> Shell::OnPrintableChar(<span class="keyword">const</span> <span class="keywordtype">char</span> C_KeyCode)
<a name="l00855"></a>00855 {
<a name="l00856"></a>00856     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#9e54ef76c3967253fd6f1a8296c38587">Put</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>), C_KeyCode);
<a name="l00857"></a>00857 }
<a name="l00858"></a>00858 
<a name="l00859"></a>00859 <span class="keywordtype">void</span> Shell::OnKeyBegin(<span class="keywordtype">void</span>)
<a name="l00860"></a>00860 {
<a name="l00861"></a>00861     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#fe0d091378e93f7729f9543ac27950b1">Home</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>));
<a name="l00862"></a>00862 }
<a name="l00863"></a>00863 
<a name="l00864"></a>00864 <span class="keywordtype">void</span> Shell::OnKeyEnd(<span class="keywordtype">void</span>)
<a name="l00865"></a>00865 {
<a name="l00866"></a>00866     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#e899273c37104d2b2d0198cd01379f30">End</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>));
<a name="l00867"></a>00867 }
<a name="l00868"></a>00868 
<a name="l00869"></a>00869 <span class="keywordtype">void</span> Shell::OnKeyLeft(<span class="keywordtype">void</span>)
<a name="l00870"></a>00870 {
<a name="l00871"></a>00871     <span class="keywordflow">if</span> (! m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#82e777328c85d7de1c5cdc491c958d13">GetLeft</a>().IsEmpty())
<a name="l00872"></a>00872     {
<a name="l00873"></a>00873         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#dc14c5b12aecb7edc159bf321d995d3e">MoveCursor</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>), -1);
<a name="l00874"></a>00874     }
<a name="l00875"></a>00875     <span class="keywordflow">else</span>
<a name="l00876"></a>00876     {
<a name="l00877"></a>00877         Beep();
<a name="l00878"></a>00878     }
<a name="l00879"></a>00879 }
<a name="l00880"></a>00880 
<a name="l00881"></a>00881 <span class="keywordtype">void</span> Shell::OnKeyRight(<span class="keywordtype">void</span>)
<a name="l00882"></a>00882 {
<a name="l00883"></a>00883     <span class="keywordflow">if</span> (! m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#3e939f8bc49e7e4be75e24dc170f6c44">GetRight</a>().IsEmpty())
<a name="l00884"></a>00884     {
<a name="l00885"></a>00885         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#dc14c5b12aecb7edc159bf321d995d3e">MoveCursor</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>), 1);
<a name="l00886"></a>00886     }
<a name="l00887"></a>00887     <span class="keywordflow">else</span>
<a name="l00888"></a>00888     {
<a name="l00889"></a>00889         Beep();
<a name="l00890"></a>00890     }
<a name="l00891"></a>00891 }
<a name="l00892"></a>00892 
<a name="l00893"></a>00893 <span class="keywordtype">void</span> Shell::OnCleanScreen(<span class="keywordtype">void</span>)
<a name="l00894"></a>00894 {
<a name="l00895"></a>00895     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#4a63de64e20b93171a892bac20417cba">NextLine</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>));
<a name="l00896"></a>00896     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#55c26585a8b2ef1c7540dd26e4ab26f1">Reset</a>();
<a name="l00897"></a>00897     <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>).<a class="code" href="classOutputDevice.html#04c4210231e603e0d398698885a9c5de">CleanScreen</a>();
<a name="l00898"></a>00898     <span class="keywordflow">if</span> (! m_qMenus.IsEmpty())
<a name="l00899"></a>00899     {
<a name="l00900"></a>00900         PromptMenu();
<a name="l00901"></a>00901     }
<a name="l00902"></a>00902 }
<a name="l00903"></a>00903 
<a name="l00904"></a>00904 <span class="keywordtype">void</span> Shell::OnBackspace(<span class="keywordtype">void</span>)
<a name="l00905"></a>00905 {
<a name="l00906"></a>00906     <span class="keywordflow">if</span> (! m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#82e777328c85d7de1c5cdc491c958d13">GetLeft</a>().IsEmpty())
<a name="l00907"></a>00907     {
<a name="l00908"></a>00908         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#366607bb40c643180bcf2c8050819bf4">Delete</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>), -1);
<a name="l00909"></a>00909     }
<a name="l00910"></a>00910     <span class="keywordflow">else</span>
<a name="l00911"></a>00911     {
<a name="l00912"></a>00912         Beep();
<a name="l00913"></a>00913     }
<a name="l00914"></a>00914 }
<a name="l00915"></a>00915 
<a name="l00916"></a>00916 <span class="keywordtype">void</span> Shell::OnSuppr(<span class="keywordtype">void</span>)
<a name="l00917"></a>00917 {
<a name="l00918"></a>00918     <span class="keywordflow">if</span> (! m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#3e939f8bc49e7e4be75e24dc170f6c44">GetRight</a>().IsEmpty())
<a name="l00919"></a>00919     {
<a name="l00920"></a>00920         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#366607bb40c643180bcf2c8050819bf4">Delete</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>), 1);
<a name="l00921"></a>00921     }
<a name="l00922"></a>00922     <span class="keywordflow">else</span>
<a name="l00923"></a>00923     {
<a name="l00924"></a>00924         Beep();
<a name="l00925"></a>00925     }
<a name="l00926"></a>00926 }
<a name="l00927"></a>00927 
<a name="l00928"></a>00928 <span class="keywordtype">void</span> Shell::OnEscape(<span class="keywordtype">void</span>)
<a name="l00929"></a>00929 {
<a name="l00930"></a>00930     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#4a63de64e20b93171a892bac20417cba">NextLine</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>));
<a name="l00931"></a>00931     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#55c26585a8b2ef1c7540dd26e4ab26f1">Reset</a>();
<a name="l00932"></a>00932     <span class="keywordflow">if</span> (! m_qMenus.IsEmpty())
<a name="l00933"></a>00933     {
<a name="l00934"></a>00934         PromptMenu();
<a name="l00935"></a>00935     }
<a name="l00936"></a>00936 }
<a name="l00937"></a>00937 
<a name="l00938"></a>00938 <span class="keywordtype">void</span> Shell::OnExit(<span class="keyword">const</span> <span class="keywordtype">bool</span> B_Edition)
<a name="l00939"></a>00939 {
<a name="l00940"></a>00940     <span class="comment">// Reset the current line if needed.</span>
<a name="l00941"></a>00941     <span class="keywordflow">if</span> (B_Edition)
<a name="l00942"></a>00942     {
<a name="l00943"></a>00943         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#4a63de64e20b93171a892bac20417cba">NextLine</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>));
<a name="l00944"></a>00944     }
<a name="l00945"></a>00945 
<a name="l00946"></a>00946     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#55c26585a8b2ef1c7540dd26e4ab26f1">Reset</a>();
<a name="l00947"></a>00947 
<a name="l00948"></a>00948     <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classMenu.html">Menu</a>* <span class="keyword">const</span> pcli_Menu = m_qMenus.RemoveTail())
<a name="l00949"></a>00949     {
<a name="l00950"></a>00950         pcli_Menu-&gt;OnExit();
<a name="l00951"></a>00951     }
<a name="l00952"></a>00952     <span class="keywordflow">if</span> (B_Edition)
<a name="l00953"></a>00953     {
<a name="l00954"></a>00954         PromptMenu();
<a name="l00955"></a>00955     }
<a name="l00956"></a>00956 }
<a name="l00957"></a>00957 
<a name="l00958"></a>00958 <span class="keywordtype">void</span> Shell::OnHelp(<span class="keyword">const</span> <span class="keywordtype">bool</span> B_Edition, <span class="keyword">const</span> <span class="keywordtype">bool</span> B_HelpOnly)
<a name="l00959"></a>00959 {
<a name="l00960"></a>00960     <span class="keywordflow">if</span> (! m_qMenus.IsEmpty())
<a name="l00961"></a>00961     {
<a name="l00962"></a>00962         <span class="comment">// Parse the command line.</span>
<a name="l00963"></a>00963         <a class="code" href="classCommandLine.html">CommandLine</a> cli_CommandLine;
<a name="l00964"></a>00964         <span class="keywordflow">if</span> (cli_CommandLine.Parse(*m_qMenus.GetTail(), m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#82e777328c85d7de1c5cdc491c958d13">GetLeft</a>(), <span class="keyword">false</span>))
<a name="l00965"></a>00965         {
<a name="l00966"></a>00966             <span class="comment">// Research matching elements.</span>
<a name="l00967"></a>00967             <a class="code" href="classElement.html#ab78652ce32d1c7cbdd83980653322b0">Element::List</a> cli_Exact(MAX_WORDS_PER_NODE), cli_Elements(MAX_WORDS_PER_NODE);
<a name="l00968"></a>00968             <span class="keywordflow">if</span> (! cli_CommandLine.<a class="code" href="classCommandLine.html#6ca91ca4b454a281bbba1b221081347a">GetLastElement</a>().<a class="code" href="classElement.html#8c27c074ba2b640795ca3657eccf3dae">FindElements</a>(
<a name="l00969"></a>00969                     cli_Exact, cli_Elements, cli_CommandLine.<a class="code" href="classCommandLine.html#9d6cf46a0e4c40a775e27f131de2eb51">GetLastWord</a>()))
<a name="l00970"></a>00970             {
<a name="l00971"></a>00971                 <span class="keywordflow">return</span>;
<a name="l00972"></a>00972             }
<a name="l00973"></a>00973 
<a name="l00974"></a>00974             <span class="comment">// Initialize completion so far.</span>
<a name="l00975"></a>00975             tk::String str_CompletionSoFar(MAX_WORD_LENGTH);
<a name="l00976"></a>00976             <span class="comment">// Determine whether help should be printed, and completion activated.</span>
<a name="l00977"></a>00977             <span class="keywordtype">bool</span> b_PrintHelpList = <span class="keyword">false</span>;
<a name="l00978"></a>00978 
<a name="l00979"></a>00979             <span class="keywordflow">if</span> (B_HelpOnly)
<a name="l00980"></a>00980             {
<a name="l00981"></a>00981                 <span class="comment">// Just print help.</span>
<a name="l00982"></a>00982                 b_PrintHelpList = <span class="keyword">true</span>;
<a name="l00983"></a>00983             }
<a name="l00984"></a>00984             <span class="keywordflow">else</span>
<a name="l00985"></a>00985             {
<a name="l00986"></a>00986                 <span class="comment">// Print help and do completion depending on the possible nodes.</span>
<a name="l00987"></a>00987                 <span class="keywordflow">if</span> (cli_Elements.IsEmpty())
<a name="l00988"></a>00988                 {
<a name="l00989"></a>00989                     <span class="comment">// No matching element.</span>
<a name="l00990"></a>00990                     Beep();
<a name="l00991"></a>00991                 }
<a name="l00992"></a>00992                 <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((cli_Elements.GetCount() == 1)
<a name="l00993"></a>00993                         &amp;&amp; (! dynamic_cast&lt;const Endl*&gt;(cli_Elements.GetHead()))
<a name="l00994"></a>00994                         &amp;&amp; (! dynamic_cast&lt;const Param*&gt;(cli_Elements.GetHead())))
<a name="l00995"></a>00995                 {
<a name="l00996"></a>00996                     <span class="comment">// Straight forward completion.</span>
<a name="l00997"></a>00997                     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#366607bb40c643180bcf2c8050819bf4">Delete</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646eadaf8b38ba63c1978ff9dcc8b9069d7">ECHO_STREAM</a>), - cli_CommandLine.<a class="code" href="classCommandLine.html#fd61a82e1157a7767e2a52d89b770c96">GetNumBackspacesForCompletion</a>());
<a name="l00998"></a>00998                     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#9e54ef76c3967253fd6f1a8296c38587">Put</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(ECHO_STREAM), cli_Elements.GetHead()-&gt;GetKeyword());
<a name="l00999"></a>00999                     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#9e54ef76c3967253fd6f1a8296c38587">Put</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(ECHO_STREAM), <span class="charliteral">' '</span>);
<a name="l01000"></a>01000                 }
<a name="l01001"></a>01001                 <span class="keywordflow">else</span>
<a name="l01002"></a>01002                 {
<a name="l01003"></a>01003                     <span class="comment">// Look for completion so far.</span>
<a name="l01004"></a>01004                     <span class="keywordtype">bool</span> b_InitCompletionSoFar = <span class="keyword">true</span>;
<a name="l01005"></a>01005                     <span class="keywordflow">for</span> (   Element::List::Iterator it = cli_Elements.GetIterator();
<a name="l01006"></a>01006                             cli_Elements.IsValid(it);
<a name="l01007"></a>01007                             cli_Elements.MoveNext(it))
<a name="l01008"></a>01008                     {
<a name="l01009"></a>01009                         <span class="keywordflow">if</span> (dynamic_cast&lt;const Param*&gt;(cli_Elements.GetAt(it))
<a name="l01010"></a>01010                             || dynamic_cast&lt;const Endl*&gt;(cli_Elements.GetAt(it)))
<a name="l01011"></a>01011                         {
<a name="l01012"></a>01012                             <span class="comment">// No completion for parameters and end of lines.</span>
<a name="l01013"></a>01013                             str_CompletionSoFar.Set(<span class="stringliteral">""</span>);
<a name="l01014"></a>01014                             <span class="keywordflow">break</span>;
<a name="l01015"></a>01015                         }
<a name="l01016"></a>01016                         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classElement.html">Element</a>* <span class="keyword">const</span> pcli_Element = dynamic_cast&lt;const Element*&gt;(cli_Elements.GetAt(it)))
<a name="l01017"></a>01017                         {
<a name="l01018"></a>01018                             <span class="keywordflow">if</span> (b_InitCompletionSoFar)
<a name="l01019"></a>01019                             {
<a name="l01020"></a>01020                                 <span class="comment">// First initialization of str_CompletionSoFar.</span>
<a name="l01021"></a>01021                                 <span class="keywordflow">if</span> (! str_CompletionSoFar.Set(pcli_Element-&gt;GetKeyword()))
<a name="l01022"></a>01022                                     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(<a class="code" href="traces_8h.html#243b1b1f8ca7e7e98ac73a2d115256f4">INTERNAL_ERROR</a>) &lt;&lt; <span class="stringliteral">"Shell::OnHelp(): Could not store completion so far"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l01023"></a>01023                                 b_InitCompletionSoFar = <span class="keyword">false</span>;
<a name="l01024"></a>01024                             }
<a name="l01025"></a>01025                             <span class="keywordflow">else</span>
<a name="l01026"></a>01026                             {
<a name="l01027"></a>01027                                 <span class="comment">// Remove last character of str_CompletionSoFar till it matches the current keyword.</span>
<a name="l01028"></a>01028                                 <span class="keywordflow">while</span> ( (! str_CompletionSoFar.IsEmpty())
<a name="l01029"></a>01029                                         &amp;&amp; (pcli_Element-&gt;GetKeyword().SubString(0, str_CompletionSoFar.GetLength()) != str_CompletionSoFar))
<a name="l01030"></a>01030                                 {
<a name="l01031"></a>01031                                     <span class="keywordflow">if</span> (! str_CompletionSoFar.Set(str_CompletionSoFar.SubString(0, str_CompletionSoFar.GetLength() - 1)))
<a name="l01032"></a>01032                                         <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(<a class="code" href="traces_8h.html#243b1b1f8ca7e7e98ac73a2d115256f4">INTERNAL_ERROR</a>) &lt;&lt; <span class="stringliteral">"Shell::OnHelp(): Could not store completion so far"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l01033"></a>01033                                 }
<a name="l01034"></a>01034                             }
<a name="l01035"></a>01035                         }
<a name="l01036"></a>01036                     }
<a name="l01037"></a>01037 
<a name="l01038"></a>01038                     <span class="comment">// When no more completion so far available, print help.</span>
<a name="l01039"></a>01039                     <span class="keywordflow">if</span> ((cli_CommandLine.<a class="code" href="classCommandLine.html#9d6cf46a0e4c40a775e27f131de2eb51">GetLastWord</a>() == NULL)
<a name="l01040"></a>01040                         || (str_CompletionSoFar == cli_CommandLine.<a class="code" href="classCommandLine.html#9d6cf46a0e4c40a775e27f131de2eb51">GetLastWord</a>()))
<a name="l01041"></a>01041                     {
<a name="l01042"></a>01042                         b_PrintHelpList = <span class="keyword">true</span>;
<a name="l01043"></a>01043                     }
<a name="l01044"></a>01044                 }
<a name="l01045"></a>01045             }
<a name="l01046"></a>01046 
<a name="l01047"></a>01047             <span class="comment">// Help display.</span>
<a name="l01048"></a>01048             <span class="keywordflow">if</span> (b_PrintHelpList)
<a name="l01049"></a>01049             {
<a name="l01050"></a>01050                 <span class="comment">// First of all, sort help elements on keywords.</span>
<a name="l01051"></a>01051                 <span class="keyword">class </span>_ { <span class="keyword">public</span>:
<a name="l01052"></a>01052                     <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> cmp(<span class="keyword">const</span> <a class="code" href="classElement.html">Element</a>* <span class="keyword">const</span>&amp; PCLI_1, <span class="keyword">const</span> <a class="code" href="classElement.html">Element</a>* <span class="keyword">const</span>&amp; PCLI_2)
<a name="l01053"></a>01053                     {
<a name="l01054"></a>01054                         <span class="keywordflow">if</span> (PCLI_1-&gt;GetKeyword() &lt; PCLI_2-&gt;<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>())
<a name="l01055"></a>01055                             <span class="keywordflow">return</span> 1;
<a name="l01056"></a>01056                         <span class="keywordflow">if</span> (PCLI_1-&gt;GetKeyword() &gt; PCLI_2-&gt;<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>())
<a name="l01057"></a>01057                             <span class="keywordflow">return</span> -1;
<a name="l01058"></a>01058                         <span class="keywordflow">return</span> 0;
<a name="l01059"></a>01059                     }
<a name="l01060"></a>01060                 };
<a name="l01061"></a>01061                 cli_Elements.Sort(_::cmp);
<a name="l01062"></a>01062 
<a name="l01063"></a>01063                 <span class="keywordflow">if</span> (B_Edition)
<a name="l01064"></a>01064                 {
<a name="l01065"></a>01065                     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#4a63de64e20b93171a892bac20417cba">NextLine</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(ECHO_STREAM));
<a name="l01066"></a>01066                 }
<a name="l01067"></a>01067 
<a name="l01068"></a>01068                 <span class="comment">// For each matching keyword...</span>
<a name="l01069"></a>01069                 <span class="keywordflow">for</span> (   Element::List::Iterator it = cli_Elements.GetIterator();
<a name="l01070"></a>01070                         cli_Elements.IsValid(it);
<a name="l01071"></a>01071                         cli_Elements.MoveNext(it))
<a name="l01072"></a>01072                 {
<a name="l01073"></a>01073                     <span class="comment">// Print the corresponding help.</span>
<a name="l01074"></a>01074                     PrintHelp(*cli_Elements.GetAt(it));
<a name="l01075"></a>01075                 }
<a name="l01076"></a>01076 
<a name="l01077"></a>01077                 <span class="keywordflow">if</span> (B_Edition)
<a name="l01078"></a>01078                 {
<a name="l01079"></a>01079                     PromptMenu();
<a name="l01080"></a>01080                 }
<a name="l01081"></a>01081             }
<a name="l01082"></a>01082             <span class="comment">// Completion so far.</span>
<a name="l01083"></a>01083             <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((! B_HelpOnly) &amp;&amp; (! str_CompletionSoFar.IsEmpty()))
<a name="l01084"></a>01084             {
<a name="l01085"></a>01085                 m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#366607bb40c643180bcf2c8050819bf4">Delete</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(ECHO_STREAM), - cli_CommandLine.<a class="code" href="classCommandLine.html#fd61a82e1157a7767e2a52d89b770c96">GetNumBackspacesForCompletion</a>());
<a name="l01086"></a>01086                 m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#9e54ef76c3967253fd6f1a8296c38587">Put</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(ECHO_STREAM), str_CompletionSoFar);
<a name="l01087"></a>01087             }
<a name="l01088"></a>01088         }
<a name="l01089"></a>01089         <span class="keywordflow">else</span>
<a name="l01090"></a>01090         {
<a name="l01091"></a>01091             <span class="keywordflow">if</span> (B_Edition)
<a name="l01092"></a>01092             {
<a name="l01093"></a>01093                 m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#4a63de64e20b93171a892bac20417cba">NextLine</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(ECHO_STREAM));
<a name="l01094"></a>01094             }
<a name="l01095"></a>01095             PrintError(
<a name="l01096"></a>01096                 (m_pcliInput != NULL) ? m_pcliInput-&gt;<a class="code" href="classIODevice.html#803bd02bf68fcbb8b40b50548b1cfb8b">GetLocation</a>() : <a class="code" href="classResourceString.html">ResourceString</a>(),
<a name="l01097"></a>01097                 cli_CommandLine.<a class="code" href="classCommandLine.html#e6af7c2f1ebc3b31be87490be4d1fb2e">GetLastError</a>()
<a name="l01098"></a>01098             );
<a name="l01099"></a>01099             <span class="keywordflow">if</span> (B_Edition)
<a name="l01100"></a>01100             {
<a name="l01101"></a>01101                 PromptMenu();
<a name="l01102"></a>01102             }
<a name="l01103"></a>01103         }
<a name="l01104"></a>01104     }
<a name="l01105"></a>01105 
<a name="l01106"></a>01106 }
<a name="l01107"></a>01107 
<a name="l01108"></a>01108 <span class="keywordtype">void</span> Shell::OnExecute(<span class="keywordtype">void</span>)
<a name="l01109"></a>01109 {
<a name="l01110"></a>01110     m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#4a63de64e20b93171a892bac20417cba">NextLine</a>(<a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(ECHO_STREAM));
<a name="l01111"></a>01111 
<a name="l01112"></a>01112     <span class="keywordflow">if</span> (! m_qMenus.IsEmpty())
<a name="l01113"></a>01113     {
<a name="l01114"></a>01114         <span class="comment">// First of all, store the line in history stack.</span>
<a name="l01115"></a>01115         m_cliHistory.<a class="code" href="classCmdLineHistory.html#6cca60b7c44901959a3583137cf01312">Push</a>(m_cliCmdLine);
<a name="l01116"></a>01116 
<a name="l01117"></a>01117         <span class="comment">// Append "\n" to the line and parse it.</span>
<a name="l01118"></a>01118         tk::String str_Line(MAX_CMD_LINE_LENGTH + 1);
<a name="l01119"></a>01119         <a class="code" href="classCommandLine.html">CommandLine</a> cli_CommandLine;
<a name="l01120"></a>01120         <span class="keywordflow">if</span> (str_Line.Set(m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#59decc58f0539006c8e816f2268cf11e">GetLine</a>()) &amp;&amp; str_Line.Append(<span class="stringliteral">"\n"</span>)
<a name="l01121"></a>01121             &amp;&amp; cli_CommandLine.<a class="code" href="classCommandLine.html#c58a33a052647d5cf76b017f18c0738a">Parse</a>(*m_qMenus.GetTail(), str_Line, <span class="keyword">true</span>))
<a name="l01122"></a>01122         {
<a name="l01123"></a>01123             <span class="keywordtype">bool</span> b_Executed = <span class="keyword">false</span>;
<a name="l01124"></a>01124             <span class="comment">// No need to execute unless there are at least one word and one endl elements in the command line.</span>
<a name="l01125"></a>01125             <a class="code" href="classCommandLineIterator.html">CommandLineIterator</a> it(cli_CommandLine);
<a name="l01126"></a>01126             <span class="keywordflow">if</span> (it.StepIt() &amp;&amp; it.StepIt())
<a name="l01127"></a>01127             {
<a name="l01128"></a>01128                 <span class="comment">// Command line execution.</span>
<a name="l01129"></a>01129                 <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classMenu.html">Menu</a>* <span class="keyword">const</span> pcli_Menu = m_qMenus.GetTail())
<a name="l01130"></a>01130                 {
<a name="l01131"></a>01131                     <span class="keywordflow">if</span> (pcli_Menu-&gt;ExecuteReserved(cli_CommandLine))
<a name="l01132"></a>01132                         b_Executed = <span class="keyword">true</span>;
<a name="l01133"></a>01133                     <span class="keywordflow">if</span> (pcli_Menu-&gt;Execute(cli_CommandLine))
<a name="l01134"></a>01134                         b_Executed = <span class="keyword">true</span>;
<a name="l01135"></a>01135                 }
<a name="l01136"></a>01136 
<a name="l01137"></a>01137                 <span class="comment">// Post-execution.</span>
<a name="l01138"></a>01138                 <span class="keywordflow">if</span> (b_Executed)
<a name="l01139"></a>01139                 {
<a name="l01140"></a>01140                     <span class="comment">// Entering a sub-menu.</span>
<a name="l01141"></a>01141                     <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classEndl.html">Endl</a>* pcli_Endl = dynamic_cast&lt;const Endl*&gt;(&amp; cli_CommandLine.GetLastElement()))
<a name="l01142"></a>01142                     {
<a name="l01143"></a>01143                         <span class="keywordflow">if</span> (pcli_Endl-&gt;GetMenuRef() != NULL)
<a name="l01144"></a>01144                         {
<a name="l01145"></a>01145                             EnterMenu(pcli_Endl-&gt;GetMenuRef()-&gt;GetMenu());
<a name="l01146"></a>01146                         }
<a name="l01147"></a>01147                     }
<a name="l01148"></a>01148                 }
<a name="l01149"></a>01149                 <span class="keywordflow">else</span>
<a name="l01150"></a>01150                 {
<a name="l01151"></a>01151                     <span class="keyword">const</span> <a class="code" href="classResourceString.html">ResourceString</a> cli_ExecutionError = <a class="code" href="classResourceString.html">ResourceString</a>()
<a name="l01152"></a>01152                         .SetString(<a class="code" href="classResourceString.html#88d585d899c8482aeb434571923739b3f12fbeaebaa487c3970ecc2cf837e0df">ResourceString::LANG_EN</a>, <span class="stringliteral">"Execution error"</span>)
<a name="l01153"></a>01153                         .SetString(<a class="code" href="classResourceString.html#88d585d899c8482aeb434571923739b3142a22fb5f61fe5c723693b4cc887f4f">ResourceString::LANG_FR</a>, <span class="stringliteral">"Erreur d'excution"</span>);
<a name="l01154"></a>01154                     PrintError(
<a name="l01155"></a>01155                         (m_pcliInput != NULL) ? m_pcliInput-&gt;<a class="code" href="classIODevice.html#803bd02bf68fcbb8b40b50548b1cfb8b">GetLocation</a>() : <a class="code" href="classResourceString.html">ResourceString</a>(),
<a name="l01156"></a>01156                         cli_ExecutionError
<a name="l01157"></a>01157                     );
<a name="l01158"></a>01158                 }
<a name="l01159"></a>01159             }
<a name="l01160"></a>01160         }
<a name="l01161"></a>01161         <span class="keywordflow">else</span>
<a name="l01162"></a>01162         {
<a name="l01163"></a>01163             PrintError(
<a name="l01164"></a>01164                 (m_pcliInput != NULL) ? m_pcliInput-&gt;<a class="code" href="classIODevice.html#803bd02bf68fcbb8b40b50548b1cfb8b">GetLocation</a>() : <a class="code" href="classResourceString.html">ResourceString</a>(),
<a name="l01165"></a>01165                 cli_CommandLine.GetLastError()
<a name="l01166"></a>01166             );
<a name="l01167"></a>01167         }
<a name="l01168"></a>01168         m_cliCmdLine.<a class="code" href="classCmdLineEdition.html#55c26585a8b2ef1c7540dd26e4ab26f1">Reset</a>();
<a name="l01169"></a>01169         PromptMenu();
<a name="l01170"></a>01170     }
<a name="l01171"></a>01171 }
<a name="l01172"></a>01172 
<a name="l01173"></a>01173 <span class="keywordtype">void</span> Shell::OnHistory(<span class="keyword">const</span> <span class="keywordtype">int</span> I_Navigation)
<a name="l01174"></a>01174 {
<a name="l01175"></a>01175     <span class="keywordflow">if</span> (! m_cliHistory.<a class="code" href="classCmdLineHistory.html#93b870593b647efed97720df0866fe07">Navigate</a>(m_cliCmdLine, <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(ECHO_STREAM), I_Navigation))
<a name="l01176"></a>01176     {
<a name="l01177"></a>01177         <span class="comment">// Out of stack.</span>
<a name="l01178"></a>01178         Beep();
<a name="l01179"></a>01179     }
<a name="l01180"></a>01180 }
<a name="l01181"></a>01181 
<a name="l01182"></a>01182 <span class="keywordtype">void</span> Shell::PrintHelp(<span class="keyword">const</span> <a class="code" href="classElement.html">Element</a>&amp; CLI_Element)
<a name="l01183"></a>01183 {
<a name="l01184"></a>01184     <span class="comment">// Retrieve basic information.</span>
<a name="l01185"></a>01185     tk::String str_Keyword = CLI_Element.<a class="code" href="classElement.html#6d9e2ee49e3a8b9306761f52a456830a">GetKeyword</a>();
<a name="l01186"></a>01186     tk::String str_Help = CLI_Element.<a class="code" href="classElement.html#b6ec72a62194f36dbfa5fe0fca5e8e09">GetHelp</a>().<a class="code" href="classResourceString.html#9810e21c1e7ec3ab7f45c099f15fd7f7">GetString</a>(<a class="code" href="classShell.html#fae8f69c25a41e89d184e3c49b1b3918">GetLang</a>());
<a name="l01187"></a>01187 
<a name="l01188"></a>01188     <span class="comment">// Optional corrections.</span>
<a name="l01189"></a>01189     <span class="keywordflow">if</span> (dynamic_cast&lt;const Endl*&gt;(&amp; CLI_Element))
<a name="l01190"></a>01190     {
<a name="l01191"></a>01191         str_Keyword.Set(<span class="stringliteral">"&lt;cr&gt;"</span>);
<a name="l01192"></a>01192     }
<a name="l01193"></a>01193     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classParam.html">Param</a>* <span class="keyword">const</span> pcli_Param = dynamic_cast&lt;const Param*&gt;(&amp; CLI_Element))
<a name="l01194"></a>01194     {
<a name="l01195"></a>01195         <span class="keywordflow">if</span> (<span class="keyword">const</span> <a class="code" href="classParam.html">Param</a>* <span class="keyword">const</span> pcli_Clone = pcli_Param-&gt;Clone())
<a name="l01196"></a>01196         {
<a name="l01197"></a>01197             pcli_Clone-&gt;SetstrValue(<span class="stringliteral">""</span>);
<a name="l01198"></a>01198             <span class="keywordflow">if</span> (! str_Keyword.Set(pcli_Clone-&gt;GetKeyword()))
<a name="l01199"></a>01199                 <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(<a class="code" href="traces_8h.html#243b1b1f8ca7e7e98ac73a2d115256f4">INTERNAL_ERROR</a>) &lt;&lt; <span class="stringliteral">"Shell::PrintHelp(): Could not review str_Keyword for the parameter"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l01200"></a>01200             <span class="keywordflow">if</span> (! pcli_Param-&gt;GetstrValue().IsEmpty())
<a name="l01201"></a>01201             {
<a name="l01202"></a>01202                 <span class="keywordflow">if</span> (! str_Keyword.Append(<span class="stringliteral">"("</span>))
<a name="l01203"></a>01203                     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(<a class="code" href="traces_8h.html#243b1b1f8ca7e7e98ac73a2d115256f4">INTERNAL_ERROR</a>) &lt;&lt; <span class="stringliteral">"Shell::PrintHelp(): Could not review str_Keyword for the parameter"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l01204"></a>01204                 <span class="keywordflow">if</span> (! str_Keyword.Append(pcli_Param-&gt;GetstrValue()))
<a name="l01205"></a>01205                     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(<a class="code" href="traces_8h.html#243b1b1f8ca7e7e98ac73a2d115256f4">INTERNAL_ERROR</a>) &lt;&lt; <span class="stringliteral">"Shell::PrintHelp(): Could not review str_Keyword for the parameter"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l01206"></a>01206                 <span class="keywordflow">if</span> (! str_Keyword.Append(<span class="stringliteral">")"</span>))
<a name="l01207"></a>01207                     <a class="code" href="traces_8h.html#757ce8f9014dd17ed7349efcdd702af9">GetTraces</a>().<a class="code" href="classTraces.html#69bc0bc6fcd2a39cb61304e6b92506c2">Trace</a>(<a class="code" href="traces_8h.html#243b1b1f8ca7e7e98ac73a2d115256f4">INTERNAL_ERROR</a>) &lt;&lt; <span class="stringliteral">"Shell::PrintHelp(): Could not review str_Keyword for the parameter"</span> &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l01208"></a>01208             }
<a name="l01209"></a>01209             <span class="keyword">delete</span> pcli_Clone;
<a name="l01210"></a>01210         }
<a name="l01211"></a>01211     }
<a name="l01212"></a>01212 
<a name="l01213"></a>01213     <span class="comment">// Display.</span>
<a name="l01214"></a>01214     <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;
<a name="l01215"></a>01215     <span class="keywordflow">for</span> (i = 0; i &lt; HELP_MARGIN; i++)
<a name="l01216"></a>01216     {
<a name="l01217"></a>01217         <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>) &lt;&lt; <span class="stringliteral">" "</span>;
<a name="l01218"></a>01218     }
<a name="l01219"></a>01219     <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>) &lt;&lt; str_Keyword &lt;&lt; <span class="stringliteral">" "</span>;
<a name="l01220"></a>01220     <span class="keywordflow">for</span> (i = str_Keyword.GetLength(); i &lt; HELP_OFFSET; i++)
<a name="l01221"></a>01221     {
<a name="l01222"></a>01222         <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>) &lt;&lt; <span class="stringliteral">" "</span>;
<a name="l01223"></a>01223     }
<a name="l01224"></a>01224     <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>) &lt;&lt; str_Help;
<a name="l01225"></a>01225     <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd646457a2dc04a7f380b028fc706855aefb9">OUTPUT_STREAM</a>) &lt;&lt; <a class="code" href="io__device_8h.html#d6d7d55b8cc249130097ce4007a1162a">endl</a>;
<a name="l01226"></a>01226 }
<a name="l01227"></a>01227 
<a name="l01228"></a>01228 <span class="keywordtype">void</span> Shell::Beep(<span class="keywordtype">void</span>)
<a name="l01229"></a>01229 {
<a name="l01230"></a>01230     <span class="keywordflow">if</span> (m_bBeep)
<a name="l01231"></a>01231     {
<a name="l01232"></a>01232         <a class="code" href="classShell.html#70af9792100a23e8b5f509737269ffe1">GetStream</a>(<a class="code" href="shell_8h.html#831be33be460d85af138038078ebd64653988cedf87c54e9e5dcc0e79f86db8e">ERROR_STREAM</a>).<a class="code" href="classOutputDevice.html#4b4cc34728972042f3a79e5e63178b7b">Beep</a>();
<a name="l01233"></a>01233     }
<a name="l01234"></a>01234 }
<a name="l01235"></a>01235 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Fri Oct 2 00:11:52 2009 for CLI by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
